<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-workshop/part-ii/service-on-demand">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Delivering your service on demand | Kratix</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://kratix.io/docs/workshop/service-on-demand"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="kratix docs, kratix documentation"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Delivering your service on demand | Kratix"><meta data-rh="true" name="description" content="Delivering your service on demand"><meta data-rh="true" property="og:description" content="Delivering your service on demand"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kratix.io/docs/workshop/service-on-demand"><link data-rh="true" rel="alternate" href="https://kratix.io/docs/workshop/service-on-demand" hreflang="en"><link data-rh="true" rel="alternate" href="https://kratix.io/docs/workshop/service-on-demand" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://0T1XCKLOOH-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kratix RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kratix Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-88SJVH10M9"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-88SJVH10M9",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Kratix" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.6d5f032a.css">
<link rel="preload" href="/assets/js/runtime~main.018423ec.js" as="script">
<link rel="preload" href="/assets/js/main.6b807c86.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/kratix_k_logo.png" alt="Kratix Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/kratix_k_logo.png" alt="Kratix Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Kratix</b></a><a class="navbar__item navbar__link" href="/docs/main/intro">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/workshop/intro">Workshop</a><a class="navbar__item navbar__link" href="/marketplace">Marketplace</a><a class="navbar__item navbar__link" href="/docs/main/community">Community</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/syntasso/kratix" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/workshop/intro">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/workshop/setup">Pre-requisites</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/docs/workshop/part-i/intro">Part I</a><button aria-label="Toggle the collapsible sidebar category &#x27;Part I&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workshop/installing-kratix">Installing Kratix</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workshop/installing-a-promise">Installing a Promise</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workshop/multiple-promises">Using Compound Promises</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/workshop/part-ii/intro">Part II</a><button aria-label="Toggle the collapsible sidebar category &#x27;Part II&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workshop/creating-an-api">Creating your first service API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/workshop/service-on-demand">Delivering your service on demand</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workshop/shared-dependencies">Extracting shared dependencies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workshop/schedule-promise">Schedule Promises</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workshop/update-status">Update the Resource Request status</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/workshop/whats-next">What&#x27;s next?</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/workshop/part-ii/intro"><span itemprop="name">Part II</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Delivering your service on demand</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Delivering your service on demand</h1></header><p>This is Part 2 of <a href="/docs/workshop/intro">a series</a> illustrating how Kratix works. <br>
👈🏾<!-- --> <!-- --> <!-- --> Previous: <a href="/docs/workshop/creating-an-api">Create your first service API</a> <br>
👉🏾<!-- --> <!-- --> <!-- --> Next: <a href="/docs/workshop/shared-dependencies">Extracting shared dependencies</a></p><hr><p><strong>In this tutorial, you will</strong></p><ul><li><a href="#what-is-a-pipeline">Learn about a Promise pipeline</a></li><li><a href="#write-docker-container">Write a Docker container to codify the delivery process</a></li><li><a href="#test-the-pipeline">Test the pipeline</a></li><li><a href="#add-container-to-pipeline">Include this container in your Promise pipeline</a></li><li><a href="#install-promise">Install the Promise</a></li><li><a href="#request-instance">Request an on-demand instance of your Promise</a></li><li><a href="#summary">Summary</a></li><li><a href="#cleanup">Clean up environment</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-a-pipeline">What is a Promise pipeline?<a href="#what-is-a-pipeline" class="hash-link" aria-label="Direct link to What is a Promise pipeline?" title="Direct link to What is a Promise pipeline?">​</a></h2><p>A <a href="/docs/main/reference/promises/intro">Kratix Promise</a> is configured with a Request
Pipeline, defined as <code>xaasRequestPipeline</code> in the Promise definition.</p><p>This pipeline is an ordered list of OCI-compliant images. Each image runs as an
init container within a single Kubernetes pod.</p><p>This pipeline is run whenever a user makes a request to your Promise API. The
pipeline is limited only by what actions you can take inside a Pod in Kubernetes.
This means you can download software, run imperative commands, wait for manual
approvals and more.</p><figure class="diagram"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 870.496 145.505" class="large"><defs><style>@font-face{font-family:&quot;Virgil&quot;;src:url(https://excalidraw.com/Virgil.woff2)}@font-face{font-family:&quot;Cascadia&quot;;src:url(https://excalidraw.com/Cascadia.woff2)}</style></defs><path fill="#fff" d="M0 0h870.496v145.505H0z"></path><g stroke-opacity="0.5" fill-opacity="0.5" fill-rule="evenodd" stroke-linecap="round"><path d="M604.98 16.076s0 0 0 0m0 0s0 0 0 0m-10.38-3.01c7.11 4.35 12.76 11.74 15.85 12.26m-14.04-12.79c4.4 6.59 10.92 10.87 14.49 14.08m-20.24-13.8c6.87 8.94 15.56 14.2 28.16 27.45m-29.32-27.02c9.59 7.21 17.34 14.73 29.32 25.89m-34.93-25.1c14.4 11.6 26.42 23.24 40.29 35.59m-39.99-36.65c13.06 11.66 26.67 23.02 39.08 36.08m-45.55-37.14c10.77 10.46 18.84 19.44 48.18 42.54m-48.51-40.73c12.65 9.94 22.47 19.64 47.36 39.77m-55.11-40.24c20.45 18.77 42.36 33.83 55.18 45.23m-52.53-45.12c16.38 14.82 36.16 32.24 52.3 46.87m-60.27-46.44c14.69 12.87 28.61 21.32 58.35 48.65m-56.26-48.09c15.98 14.01 31.57 26.93 55.93 47.93m-61.72-47.26c10.88 11.32 25.44 21.47 61.4 52.2m-63.54-54.28c24.27 23.01 49.09 42.79 64.05 55.62m-70.6-55.76c20.3 18.22 43.11 37.63 67.3 60.65m-65.49-60.22c15.78 15.64 32.58 29.54 67.9 58.62m-72.65-58.34c18.78 19.69 38.44 34.41 71.58 63.95m-73.97-63.76c27.76 22.74 53.88 45.53 72.43 62.43m-78.35-64.02c24.39 19.94 50.41 41.92 78.84 69.92m-79.14-69.33c22.93 18.37 43.06 38.58 77.84 69.09m-81.88-66.97c24.13 19.13 47.82 40.53 81.78 71.63m-82.59-72.98c27.4 24.47 55.91 49.26 83.53 73.56m-88.21-73.15c27.88 25.49 53.9 51.32 86.33 76.75m-87.59-76.2c17.58 14.98 35.14 30.69 88.36 76.03m-94.28-75.52c22.09 19.02 46.3 38.8 91.04 78.12m-90.53-78.21c26.93 22.87 53.51 45.91 90.92 79.53m-99.2-82.58c28.39 23.51 53.93 49.81 99.55 86.49m-98.51-85.22c37.77 33.36 76.02 66.93 97.03 85.66m-105.36-85.61c42.84 34.71 79.12 68.26 104.49 87.2m-103.33-86.73c40.05 34.36 79.4 68.69 102.71 88.25m-108.82-89.36c30.04 29.07 61.79 53.98 106.84 90.82m-105.95-88.77c26.22 21.97 49.94 42.89 104.44 89.06m-110.52-91.11c28.72 26.64 58.3 52.51 105.67 94.44m-106.31-92.73c31.41 25.4 62.55 53.17 107.95 91.94m-111.39-92.71c36.38 34.23 77.86 68.26 107.8 96.39m-110.1-96.76c30.25 26.24 61.13 53.96 110.91 96.73m-115.3-95.7c35.04 30.58 70.5 60.9 110.43 98.26m-111.46-99.33c28.47 24.12 55.97 47.55 112.49 100.13M482 12.396c29.85 28.79 62.17 55.06 113.49 101.52M481.01 13.486c34.52 30.91 69.35 60.75 114.81 99.39m-.3.98s0 0 0 0m0 0s0 0 0 0M473.45 12.306c33.3 27.97 66.24 54.41 115.48 101.59M474.99 13.226c31.21 29.59 63.84 57.24 115.41 101.33M469.8 14.006c23.57 22.66 49.8 44.04 113.92 101.46m-115.91-101.6c38.53 35.4 78.85 69.56 115.31 100.9M460.68 14.186c24.45 19.36 47.12 39.23 115.36 100.89M462.78 14.206c40 36.18 83.1 73.35 114.6 100.18M456.47 13.676c36.77 34.27 78.23 68.25 114.59 100.78M456.84 14.276c31.71 27.69 64.6 56.28 114.02 100.17m-118.9-98.99c39.2 35.8 84.84 73.43 112.72 98.04m-114.06-99.39c30.95 29.48 65.42 58.23 114.72 100.46M445.41 13.516c35.77 30.39 69.12 60.51 114.4 101.34m-116.44-100c31.58 27.03 62.62 53.87 116.63 100.15M438.83 13.486c32.2 30.49 66.69 58.13 114.63 99.37m-115.28-99.88c27.21 23.9 53.33 47.19 114.1 100.89m-119.43-101.1c41.72 39.14 87.94 77.31 112.18 101.31M432.7 14.596c25.22 23.46 52.91 46.47 114.48 98.62m-119.71-98.66c38.94 32.7 76.26 68.89 111.68 98.89M424.89 13.126c38.92 33.52 74.29 66.04 115.08 100.38m-119.53-98.93c24.66 22.06 51.18 47.15 114.01 97.83m-115.27-98.14c34.66 31.05 67.96 60.7 114.66 98.87m-121.6-97.29c31.48 24.24 62.09 47.38 117.69 97.61M412.5 14.216c36.24 31.99 71.98 61.56 115.73 99.28m-119.75-98.14c28.66 26.41 63.59 55.59 113.47 99.72m-115.5-102.29c35.57 30.97 71.07 62.13 116.26 100.37m-122.06-99.03c35.11 30.26 67.85 57.35 113.97 100.19m-113.56-99.47c36.25 28.28 70.88 58.64 114.15 98.14m-118.27-99.61c37.86 35.67 79.22 70.26 111.63 99.51M395.45 12.846c29.5 27.34 59.77 54.76 114.35 100.75m-119.21-98.52c26.6 23.62 55.79 47.61 113.14 98.25m-114.59-98.43c31.32 26.98 64.14 53.36 114.18 99m-120.41-99.04c25.48 21.01 52.52 42.78 116.82 100.69M382.92 13.956c34.64 29.73 66.55 58.78 115.76 101.14m-122.29-99.84c28.51 24.27 52.57 44.56 114.5 98.48m-114-99.16c35.28 30.06 70.82 61.6 114.89 99.4m-122.09-99.41c32.83 28.21 65.33 57.23 116.86 98.42m-115.16-98.9c33.08 28.39 68.14 58.61 113.35 98.83m-118.72-97.43c32.85 27.84 67.34 59.59 115.89 97.87m-117.68-98.65c41.14 35 82.47 70.25 116.39 99.72M359.93 13.206c31.3 27.29 59.84 54.26 114.85 98.83m-115.35-98.04c31.54 28.2 64.11 55.94 113.7 100.61M354.11 13.486c28.4 23.26 55.59 47.82 113.87 100.43m-115.09-99.52c34.28 31.52 70.36 62.76 115.99 99.84m-123.15-98.88c36.97 31.02 74.79 66.72 116.6 99.1m-115.65-100.2c29.47 25.95 60.05 51.85 114.64 98.76m-121.87-99.14c40.42 33.53 83.41 67.79 115.53 100.48M340.91 14.066c35.31 32.29 70.3 63.07 114.03 100.5m-121.13-99.71c42.13 31.46 81.59 67.21 114.45 98.73M334.05 13.556c38.68 32.25 75.81 63.6 115.01 100.42M329.98 12.866c27.99 28.94 59.25 56.68 114.45 102.67M328.59 15.106c25.45 22.99 52.35 45.54 113.87 99.19m-119.88-98.87c31.4 26.01 61.5 50.83 115.47 100.22M321.78 14.356c40.72 36.57 83.28 72.83 114.89 100.24m-120.63-99.04c42.45 35.04 87.77 75.23 114.97 98.67M316.82 14.186c23.8 21.67 48.41 41.26 114.07 98.99m-119.3-100.47c30.82 30.35 66.85 59.59 113.24 100.41m-114.96-99.15c41.45 37.75 82.48 72.86 115.37 99.67m-121.6-100.33c43.23 37 82.55 71.36 115.89 102.46M303.24 13.626c35.18 29.46 70.77 59.86 116.23 99.76m-120.92-98.46c35.89 29.79 72.02 63.29 115.83 98.42m-116.24-99.22c34.78 32.07 70.1 63.06 114.54 98.99M291.45 12.346c27.74 23.57 56.8 48.68 114.8 103.06m-113.91-102.4c27.34 25.69 55.77 49.65 115.18 100.9m-122.96-97.7c43.24 34.38 85.93 71.94 114.09 96.44m-112.19-99.26c31.63 29.02 64.42 57.28 113.72 100m-119.91-97.54c44.63 36.92 90.95 75.83 115.79 99.79M279.87 14.246c32.74 29.01 66.13 57.73 114.74 98.61m-122.45-98.28c29.97 25.53 57.58 49.08 116.58 98.28m-115.02-98.77c40.67 35.19 79.71 70.72 114.52 100.66M266.08 12.526c35.82 31.32 71.6 62.83 117.43 102.31M266.88 13.196c39.8 36.2 78.53 70.58 115.78 99.93M262.5 13.296c36.99 33.33 75.85 67 113.64 101.45m-116-100.04c32.73 26.5 64.17 54.24 116.76 99.08m-119.63-99.75c41.9 39.44 83.48 76.37 113.04 99.27m-114.34-99.27c31.59 25.44 62.02 52.7 114.37 99.4m-121.9-99.9c27.61 24.64 53.57 44.04 113.57 101.8m-112.8-101.85c27.13 25.81 55.47 48.81 114.78 100.28M244.61 12.916c39.86 36.44 83.74 74.96 113.71 101.01m-114.01-99.71c40.89 37.38 81.14 72.14 112.83 99.74M235.96 12.386c29.18 25.71 55.92 51.06 114.23 100.11m-113.95-98.98c33.38 29.55 67.24 58.13 114.91 100.66M231.3 12.606c39 36.45 80.95 70.94 115.51 102.86m-116.24-99.97c28.88 24.91 58.2 50.4 115.03 99.15m-118.14-97.19c38.59 31.47 76.28 64.07 113.17 97.61m-114.04-98.78c31.98 28.95 63.63 57.5 113.72 97.57m-117.6-97.09c36.16 34.42 74.36 65.18 110.99 97.2m-109.91-95.76c26.01 23.37 54.18 47.26 109.75 95.42m-115.05-93.31c44.11 39.55 87.05 74.36 107.98 95.1m-107.08-95.29c40.45 35.96 82.45 71.11 108.32 94.47m-112.37-91.28c24.14 18.92 51.87 42.18 105.25 92m-103.35-92.94c39.52 37.14 80.63 73.11 104.85 92.38m-108.07-90.33c30.97 30.32 65.64 59.36 101.23 90.43m-100.41-87.7c30.18 26.16 61.66 52.86 101.26 86.32m-103.26-81.68c35.12 28.19 65.93 56.28 97.37 81.56m-96.7-83.35c31.69 29.77 65.33 57.55 94.67 84.73m-98.52-80.23c33 29.78 71.1 58.77 92.48 78.42m-91.73-79.29c29.08 23.54 55.81 48.1 92.66 79.58m-96.56-77.27c23.08 20.26 45.29 41.61 88.94 78.56m-87.48-77.79c28.94 26.72 59.32 51.58 88.56 78.02m-90.12-71.57c18.88 16.37 37.49 31.96 84.61 68.87m-82.38-70.4c18.06 15.8 36.09 30.88 82.35 72.17m-84.38-67.42c24.4 18.79 43.31 38.27 78.01 68.67m-77.55-69.67c17.46 17.23 35.1 32.42 78.82 69.3m-79.67-64.43c19.4 16.68 36.52 33.61 73.65 65.29m-74.26-64.24c29.87 24.34 57.16 47.24 73.92 62.27m-73.04-57.55c17.16 14.6 34.31 31.07 64.17 58.55m-65.13-58c16.96 13.34 35.42 28.94 65.81 57.12m-64.44-51.48c15.45 13.26 33.77 28.86 58.97 50.17m-60.92-51.06c20.93 15.75 40.79 34.03 62.68 53.46m-63.44-46.12c15.93 10.24 29.52 18.68 56.02 43.83m-53.35-46.37c13.68 12.75 30.31 26.29 53.38 47.48m-53.04-40.92c16.5 12.25 31.46 28.74 47.36 41.67m-48.74-41.91c13.36 11.31 24.37 21.49 48 41.56m-46.91-34.34c13.14 6.67 23.21 19.02 40.11 34.52m-40.11-35.38c13.62 10.02 25.96 21.28 41.84 35.31m-40.5-29.51c12.03 10.26 22.55 21 32.94 28.95m-35.75-30.95c15.23 11.83 27.68 25.18 36.96 31.84m-.6-.67s0 0 0 0m0 0s0 0 0 0m-33.56-23.36c8.08 5.82 15.08 13.92 29.02 24.12m-28.56-24.4c6.39 7.25 14.09 11.05 26.41 23.05" stroke="#b2f2bb" stroke-width="0.5" fill="none"></path><path d="M591.81 12.816c-52.63.05-257.29 0-316.25-.31-58.96-.31-28.66-2.29-37.48-1.54-8.83.76-10.65 2-15.47 6.07s-10.5 10.23-13.45 18.37c-2.94 8.14-4.99 20.51-4.23 30.47.75 9.96 4.8 21.84 8.77 29.29 3.97 7.45 10.34 12.35 15.05 15.44 4.72 3.09 6.39 2.79 13.26 3.07 6.88.29-25.73-1.39 28-1.38 53.73.01 240.73 1.29 294.35 1.46 53.63.17 19.98.84 27.41-.44s12.77-3.55 17.19-7.24c4.42-3.69 6.7-7.31 9.33-14.9 2.63-7.58 5.96-21.43 6.44-30.61.47-9.17-.42-16.94-3.59-24.43-3.16-7.49-10.48-16.41-15.38-20.5-4.9-4.08-11.58-3.48-14.03-4.01-2.45-.53-.79 1.01-.69.84m1.99-.57c-52.76-.11-259.81-.39-318.64-.13-58.83.25-26.1.74-34.36 1.66-8.26.92-9.91.43-15.19 3.87-5.29 3.43-13.3 8.42-16.54 16.75-3.23 8.33-3.49 22.94-2.87 33.23.62 10.28 2.59 21.45 6.58 28.48 4 7.03 12.71 10.92 17.39 13.69 4.67 2.76 3.85 2.38 10.66 2.88 6.81.51-24.26-.18 30.19.17 54.45.34 242.92 1.93 296.49 1.9 53.57-.03 17.71-.76 24.94-2.11 7.23-1.34 13.9-2.85 18.45-5.97 4.55-3.13 6.36-5.17 8.87-12.78 2.51-7.61 5.98-23.49 6.2-32.86.22-9.38-1.6-16.22-4.9-23.37-3.3-7.15-10.1-15.02-14.92-19.52-4.81-4.51-11.52-6.44-13.99-7.5-2.48-1.05-.76 1.12-.85 1.16" stroke="#087f5b" fill="none"></path></g><path d="M322.555 12.413c-1.82.12-8.04-.86-11.27 1.37-3.24 2.24-5.91 7.53-8.15 12.05-2.23 4.52-4.28 8.73-5.26 15.09-.97 6.36-1.39 14.71-.58 23.09.8 8.38 2.67 20.01 5.39 27.17 2.73 7.15 7.47 12.42 10.96 15.75 3.49 3.33 8.47 3.82 9.96 4.24m-3.3-100.02c-1.51.41-4.76 2.59-7.29 4.91-2.52 2.32-5.69 4.81-7.86 9.01-2.18 4.2-4.34 9.97-5.19 16.21-.86 6.24-.07 12.7.06 21.24.12 8.54-1.27 22.53.67 30.01 1.94 7.49 7.01 11.91 10.94 14.9 3.93 2.99 10.62 2.46 12.64 3.04M406.999 11.332c-1.38.28-5.86-.34-8.29 2.24-2.44 2.57-4.83 8.68-6.3 13.22-1.47 4.55-1.86 8.06-2.53 14.04-.66 5.99-1.73 13.66-1.49 21.87.25 8.2.77 20.19 2.96 27.36 2.19 7.17 7.14 12.51 10.17 15.68 3.04 3.17 6.86 2.53 8.04 3.34m-1.88-95.86c-1.01.66-5.21.33-7.43 2.56-2.23 2.24-4.06 6.59-5.91 10.84-1.85 4.24-4.1 8.34-5.2 14.62-1.09 6.28-1.91 14.78-1.37 23.07.54 8.29 2.62 19.77 4.6 26.69 1.98 6.92 4.29 11.46 7.29 14.82 3.01 3.36 9.03 4.76 10.74 5.32M513.995 12.483c-1.48.24-5.59.38-7.92 2.89-2.34 2.52-4.36 7.77-6.1 12.18-1.73 4.41-3.36 8.25-4.32 14.27-.97 6.01-1.81 13.29-1.46 21.83.34 8.53 1.53 21.95 3.52 29.37 1.99 7.41 5.69 12.29 8.43 15.12 2.74 2.83 6.54 1.37 8.01 1.85m.91-95.52c-1.77-.01-7.84-2.22-10.52-.09-2.69 2.14-3.96 8.25-5.61 12.89-1.64 4.65-3.34 8.64-4.28 14.97-.93 6.33-2.01 14.83-1.32 23.01.69 8.19 3.17 18.81 5.46 26.1 2.29 7.29 5.74 14.18 8.3 17.63 2.55 3.44 5.48 2.39 7.03 3.04M600.465 11.343c-1.53.37-5.33.97-7.77 3.43-2.45 2.47-5.05 7.04-6.88 11.36-1.84 4.33-3.76 8.31-4.14 14.61-.38 6.3 1.22 14.84 1.85 23.2.63 8.37.06 19.72 1.94 27 1.87 7.29 6.61 13.67 9.32 16.74 2.7 3.07 5.8 1.1 6.92 1.66m-.58-96.24c-1.25.18-4.4-1.33-6.64.74-2.24 2.06-5 7.12-6.8 11.64-1.8 4.52-3.34 9.33-3.99 15.48-.66 6.16.16 12.91.07 21.46-.09 8.54-2.13 22.09-.62 29.8 1.5 7.7 6.53 13.23 9.65 16.42 3.11 3.2 7.4 2.59 9.04 2.77" stroke="#087f5b" fill="none" stroke-linecap="round"></path><g mask="url(#mask-igj1dKExd5gtrFBx0EVBH)" stroke-linecap="round"><path d="M68.595 65.442c9.29-.04 34.02-.24 55.71-.24 21.7 0 62.07.2 74.48.24m-130.19 0c9.29-.04 34.02-.24 55.71-.24 21.7 0 62.07.2 74.48.24M170.555 75.592c10.58-3.8 21.16-7.61 28.23-10.15m-28.23 10.15c8.05-2.89 16.1-5.79 28.23-10.15" stroke="#2f9e44" stroke-width="4" fill="none"></path><path d="M170.635 55.072c10.55 3.89 21.1 7.77 28.15 10.37m-28.15-10.37c8.02 2.96 16.05 5.91 28.15 10.37" stroke="#2f9e44" stroke-width="4" fill="none"></path></g><mask id="mask-igj1dKExd5gtrFBx0EVBH"><path fill="#fff" d="M0 0h298.784v165.678H0z"></path><path d="M94.341 55.206h59.936v20H94.341z"></path></mask><text x="29.968" font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#2f9e44" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(94.34 55.206)">request</text><text font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#1e1e1e" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(214.997 54.212)">transform</text><text font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#1e1e1e" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(520.198 55.075)">notify</text><text x="32.16" font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#1e1e1e" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(311.55 33.205)">validate</text><text x="32.16" y="20" font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#1e1e1e" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(311.55 33.205)">secure</text><text x="32.16" y="40" font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#1e1e1e" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(311.55 33.205)">scan</text><text x="38.776" font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#1e1e1e" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(405.472 45.806)">billing</text><text x="38.776" y="20" font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#1e1e1e" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(405.472 45.806)">compliance</text><g mask="url(#mask-rhLsx3B3GVveE0L1Vk06m)" stroke-linecap="round"><path d="M631.582 68.567c22.18-.11 110.92-.56 133.11-.68m-133.11.68c22.18-.11 110.92-.56 133.11-.68M736.552 78.297c9.48-3.51 18.96-7.01 28.14-10.41m-28.14 10.41c10.77-3.99 21.55-7.97 28.14-10.41" stroke="#1971c2" stroke-width="4" fill="none"></path><path d="M736.442 57.777c9.52 3.41 19.04 6.82 28.25 10.11m-28.25-10.11c10.82 3.87 21.63 7.75 28.25 10.11" stroke="#1971c2" stroke-width="4" fill="none"></path></g><mask id="mask-rhLsx3B3GVveE0L1Vk06m"><path fill="#fff" d="M0 0h864.687v169.243H0z"></path><path d="M671.631 58.229h53.008v20h-53.008z"></path></mask><text x="26.504" font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#1971c2" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(671.63 58.229)">output</text><g stroke-linecap="round"><path d="m790.757 28.944 70.64-2.51.6 111.01-72.4-3.69" stroke-width="0" fill="#fff"></path><path d="M789.197 28.524c28.61-.65 54.9-.44 72.22-1.85m-71.03 1.63c23.24-.65 46.8.91 69.54-.07m.89-.44c-1.41 36.53-.36 69.12-1.77 107.61m.98-106.69c-.61 21.64.28 44.49.89 105.83m-.04 1.94c-16.44-.53-33.94-2.44-72.7-1.33m72.04 1.33c-27.65-.49-54.49-.43-70.62-.59m-.1-.14c1.09-32.09-.54-64.3-.49-108.78m.7 107.86c.75-41.65-.71-84.09.26-106.52" stroke="#1971c2" stroke-width="2" fill="none"></path></g><g stroke-linecap="round"><path d="m783.17 19.414 71.28 3.76-1.73 103.56-68.78 1.9" stroke-width="0" fill="#fff"></path><path d="M782.34 20.874c19.71.11 43.51-1.31 71.31 2.29m-71.26-2.65c19.88 1.53 39.34.67 70.78.53m-1.1 1.76c1.22 21.3-.4 44.77-1 104.22m1.58-105.81c.39 29.24.22 56.1-.28 107.49m1.64.64c-17.55-1.57-37.06-.87-69.86-.34m68.73-.58c-25.64.76-53.46 1.14-70.6-.84m-.21 1.3c-1.46-35.45-.43-72.66 2.12-107.82m-1.37 107.55c-1.34-31.23-.28-62.55-.08-107.04" stroke="#1971c2" stroke-width="2" fill="none"></path></g><g stroke-linecap="round"><path d="m774.375 14.92 68.95-3.69 1.9 109.15-71.14-.89" stroke-width="0" fill="#fff"></path><path d="M771.325 12.82c24.61-1.29 46.54 2.22 71.89 1.31m-70.36-.31c21-.35 43.34-.53 69.86-.68m1-.52c-2.08 29.95-2.51 58.28-.84 106.67m1.27-105.61c-.49 35.5-1.49 73.84-1.16 106.74m1.26-1.25c-26.98 1.01-48.11 1.88-69.83.51m70.09.55c-29.3.35-57.22-.94-71.32-.16m-2.14.6c1.13-35.21 3.85-67.58 1.66-107.92m-.74 107.62c.47-25.11.79-49.86 1.36-108.3" stroke="#1971c2" stroke-width="2" fill="none"></path></g><path d="M784.771 62.278c6.61.25 31.6.67 39.57.03 7.97-.64 6.96-3.27 8.26-3.87m-49.34 3.09c7-.04 35.1-.81 43.29-1.12 8.2-.31 4.86-.67 5.89-.76M785.767 30.682c3.02-.59 11.08-3.31 18.94-3.43 7.87-.11 23.65 2.44 28.26 2.74m-45.49-.13c2.96-.46 9.38-1.42 16.89-1.17 7.52.24 23.47 2.48 28.2 2.65M787.8 97.457c4.67-.11 19.84-.27 25.94 0 6.1.28 7.13 1.78 10.66 1.65 3.54-.12 8.9-1.83 10.55-2.4m-48-.4c4.66.07 20.08 2.11 26.2 2.72 6.13.61 6.89 1.67 10.56.95 3.67-.73 9.41-4.65 11.48-5.3M784.146 108.96c1.52-.31 7.05-2.11 9.62-2.09 2.57.02-.08 1.76 5.8 2.2 5.88.44 23.04.87 29.47.42 6.42-.45 7.78-2.67 9.09-3.12m-55.08 1.57c1.28-.15 7.22.13 9.84.02 2.63-.12-.11-1.14 5.9-.7 6.01.44 23.8 3.43 30.14 3.33 6.33-.11 6.39-3.16 7.86-3.95M783.88 44.463c2.91.06 10.35.83 18.03 1.28 7.68.45 23.24 1.24 28.08 1.45m-47.49-.57c2.69-.26 10.72-2.78 18.45-2.47 7.73.31 22.85 3.71 27.91 4.34M783.828 80.816c1.21.38 4.35.7 7.43.4 3.08-.31 4.63-2.34 11.04-2.23 6.42.11 22.78 2.54 27.48 2.9m-47.42-1.58c1.59.65 8.03 2.46 11.25 2.44 3.22-.02 2.09-2.63 8.07-2.57 5.98.06 22.67 2.73 27.82 2.91" stroke="#1971c2" fill="none" stroke-linecap="round"></path><g stroke-linecap="round"><path d="m9.56 27.263 51.96 1.55 1.79 78.29-54.64.68" stroke-width="0" fill="#fff"></path><path d="M8.35 26.333c19.31.17 39.76 2.37 55.76 3.32m-54.66-2.21c22.26.29 42.07-.45 54.28 1.13m-1.04-1.33c.42 25.79-.98 48-1.67 80.75m2.32-80.92c.72 29.58.72 59.87-.2 81.76m-.52.46c-16.24-.67-35.37-3.4-51.06-2.11m50.73 1.35c-12.33-.15-25.1-1.07-51.61-.72m-2.5 0c1.18-19.91.74-41.53.02-80.08m1.8 79.98c-.1-19.18-1.5-39.53-.68-79.84" stroke="#2f9e44" stroke-width="2" fill="none"></path></g><path d="M16.7 61.793c5.01.21 24.61 1.33 30.61.96 6-.38 4.56-2.74 5.4-3.2m-34.37 1.17c5.44-.1 25.73.28 31.35.31 5.61.03 1.88.39 2.35-.16M18.534 39.156c2.3-.34 7.63-2.77 13.37-2.86 5.74-.09 17.45 2.23 21.08 2.34m-32.59-.12c2.26-.13 5.37-.35 10.66-.68 5.28-.33 17.21-1.22 21.07-1.28M19.287 88.67c3.36-.08 14.61.21 19.35.3 4.74.09 6.34.68 9.07.25 2.73-.43 6.06-2.45 7.31-2.83m-37.09 1.24c3.24-.51 14.78-.9 19.67-.52 4.88.38 6.7 2.81 9.63 2.81 2.93-.01 6.86-2.4 7.95-2.85M16.551 97.55c1.32-.34 6.29-2.22 8.3-2.54 2.01-.32-.65.23 3.76.61 4.4.37 17.94 1.8 22.67 1.63 4.73-.16 4.59-2.37 5.7-2.64m-41.98 2.16c1.19-.24 7.05-.8 9.18-.84 2.13-.04-.98.2 3.58.58 4.56.38 18.58 2.02 23.78 1.71 5.21-.31 6.7-3.03 7.44-3.6M17.474 48.443c2.27-.29 7.13-.46 12.89-.07 5.75.38 18.08 2.07 21.63 2.39m-35.7-.32c2.11-.21 7.21-1.22 13.03-.96 5.83.25 18.19 2.21 21.92 2.46M16.864 74.542c.92.33 4 1.67 6.23 1.61 2.23-.06 2.24-2.13 7.16-1.97 4.92.16 18.81 2.62 22.37 2.92m-37.3-.38c.72.62 4.51 1.1 6.84.83 2.33-.27 1.97-2.58 7.14-2.44 5.17.14 19.83 3.14 23.87 3.27" stroke="#2f9e44" fill="none" stroke-linecap="round"></path></svg><figcaption>An example multi-stage Pipeline</figcaption></figure><p>In addition to running commands within the images, Kratix will manage a few key
files when the defined pipeline completes:</p><ul><li><code>/output</code>: The files in this directory should be Kubernetes valid YAML as they
will be scheduled to a matching Kratix Cluster.</li><li><code>/metadata/cluster-selectors.yaml</code>: Any YAML key:value pairs in this file will
be appended to the <code>selector</code> values in the Promise before deciding where the
output files are scheduled.</li><li><code>metadata/status.yaml</code>: A YAML document that will be written to the Resource
Request status section on pipeline completion.</li></ul><p>This step of the workshop will focus on the script run in an image and the output
directory. Both cluster-selectors and status will be explored in an upcoming
section of this workshop.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="design-principles">Design principles<a href="#design-principles" class="hash-link" aria-label="Direct link to Design principles" title="Direct link to Design principles">​</a></h3><p>While the pipeline enables flexibility, you will benefit from keeping in mind
a few key principles while writing your pipeline images.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="reusability">Reusability<a href="#reusability" class="hash-link" aria-label="Direct link to Reusability" title="Direct link to Reusability">​</a></h4><p>Pipelines are a great place to validate and enforce common requirements. For
example, if you write an image that can check for necessary compliance
requirements, that image can be used by all applicable pipelines. In addition,
you can write images to check for excess costs, labeling conventions, security
risks, and more.</p><p>While most pipelines will have at least one image with unique logic, building these
images with reusability in mind is a great way to make your platform extensible.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="idempotency">Idempotency<a href="#idempotency" class="hash-link" aria-label="Direct link to Idempotency" title="Direct link to Idempotency">​</a></h4><p>An idempotent container guarantees that running the same command multiple times
will result in the same outcome. This is an important feature of these containers
because they will be auto-reconciled on an on going basis.</p><p>Kubernetes controllers reconcile their objects in three scenarios:</p><ul><li>Object change</li><li>Controller restart</li><li>Default cadence</li></ul><p>This means that yes, on every Resource Request the pipeline will run. But also, it
will run any time the controller is reset, as well as every 10 hours.</p><p>This means you will need to write your pipeline images to make sure that rerunning
them will not result in any adverse side effects.</p><hr><p>Now that you understand what you can do in a pipeline and some design principles
for writing images, it is time to write your own pipeline to deliver on-demand
Elastic Clouds!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="write-docker-container">Codify your delivery process in a Container<a href="#write-docker-container" class="hash-link" aria-label="Direct link to Codify your delivery process in a Container" title="Direct link to Codify your delivery process in a Container">​</a></h2><p>To provision Elastic Cloud Kubernetes (ECK) you will need to both install the
operator and use the ECK-stack Helm chart to make requests to the operator. By
encapsulating the process in a Container you are able to manage quite complex
actions while also having access to a testable interface.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="write-the-pipeline-script">Write the pipeline script<a href="#write-the-pipeline-script" class="hash-link" aria-label="Direct link to Write the pipeline script" title="Direct link to Write the pipeline script">​</a></h3><p>The pipeline requires a number of files and scripts. For that reason it is
best to create a subfolder to organise these specific items.</p><p>More specifically, the first two files you will need are:</p><ul><li><code>run</code>: a script containing the code that will be executed when the pipeline
runs.</li><li><code>default-config.yaml</code>: a values document containing configuration options for the
default ElasticSearch and Kibana.</li><li><code>beats-values.yaml</code>: a values document containing configuration options for when the
Data Collection is enabled.</li></ul><p>To create the subfolder and these two executable files, you can run the following command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> -p pipeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">touch</span><span class="token plain"> pipeline/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">run,default-config.yaml,beats-values.yaml</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> +x pipeline/run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next you will write the code that manages the provisioning process in the <code>run</code>
script. Paste the contents below in the <code>pipeline/run</code> script:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">pipeline/run</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token shebang important">#!/usr/bin/env bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">set</span><span class="token plain"> -eu -o pipefail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> -p to-deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable" style="color:#36acaa">yq </span><span class="token string variable builtin class-name" style="color:#36acaa">eval</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&#x27;.metadata.name&#x27;</span><span class="token string variable" style="color:#36acaa"> /input/object.yaml</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">enableDataCollection</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable" style="color:#36acaa">yq </span><span class="token string variable builtin class-name" style="color:#36acaa">eval</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&#x27;.spec.enableDataCollection&#x27;</span><span class="token string variable" style="color:#36acaa"> /input/object.yaml</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Downloading CRDS...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> --silent --location --output to-deploy/elastic-crds.yaml </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    https://download.elastic.co/downloads/eck/2.8.0/crds.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Downloading Operator...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> --silent --location --output to-deploy/elastic-operator.yaml </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    https://download.elastic.co/downloads/eck/2.8.0/operator.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Generate ECK requests...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Only set the beats value file if data collection is enabled</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">valuesFile</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$enableDataCollection</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">sed</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;s/NAME/</span><span class="token string variable" style="color:#36acaa">${name}</span><span class="token string" style="color:#e3116c">/g&quot;</span><span class="token plain"> beats-values.yaml </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> beats-final-values.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token assign-left variable" style="color:#36acaa">valuesFile</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;--values beats-final-values.yaml&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">nodePort</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable builtin class-name" style="color:#36acaa">echo</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&quot;</span><span class="token string variable string variable" style="color:#36acaa">${name}</span><span class="token string variable string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable operator" style="color:#393A34">|</span><span class="token string variable" style="color:#36acaa"> md5sum </span><span class="token string variable operator" style="color:#393A34">|</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable function" style="color:#d73a49">grep</span><span class="token string variable" style="color:#36acaa"> -Eo </span><span class="token string variable string" style="color:#e3116c">&quot;[[:digit:]]{3}&quot;</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable operator" style="color:#393A34">|</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable function" style="color:#d73a49">head</span><span class="token string variable" style="color:#36acaa"> -n1</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">nodePort</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$((</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable number" style="color:#36acaa">30000</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">+</span><span class="token variable" style="color:#36acaa"> nodePort </span><span class="token variable" style="color:#36acaa">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sed</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;s/NODEPORT/</span><span class="token string variable" style="color:#36acaa">${nodePort}</span><span class="token string" style="color:#e3116c">/g&quot;</span><span class="token plain"> default-config.yaml </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sed</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;s/NAME/</span><span class="token string variable" style="color:#36acaa">${name}</span><span class="token string" style="color:#e3116c">/g&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> default-config-final-values.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm template </span><span class="token variable" style="color:#36acaa">$name</span><span class="token plain"> eck-stack </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token variable" style="color:#36acaa">$valuesFile</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --values default-config-final-values.yaml </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --repo https://helm.elastic.co </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --output-dir to-deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Adding namespaces to all helm output files...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> /pipeline/to-deploy/eck-stack -name </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">*.yaml   -exec yq -i </span><span class="token string" style="color:#e3116c">&#x27;select(.metadata | has(&quot;namespace&quot;) | not).metadata.namespace |= &quot;default&quot;&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Removing enterprise annotation...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> /pipeline/to-deploy/eck-stack -name </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">*.yaml   -exec yq -i </span><span class="token string" style="color:#e3116c">&#x27;del(.metadata.annotations[&quot;eck.k8s.elastic.co/license&quot;])&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Copying files to /output...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> /pipeline/to-deploy -name </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">*.yaml -exec </span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> /output </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Done&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, populate the <code>default-config.yaml</code> document. This is file contains default
configuration for the Kibana deployment. The NodePort will be injected by the
pipeline:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">pipeline/default-config.yaml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">eck-elasticsearch</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">fullnameOverride</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">eck-kibana</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">fullnameOverride</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">csp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">strict</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">count</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">elasticsearchRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">tls</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">selfSignedCertificate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">disabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">service</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> NodePort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token key atrule" style="color:#00a4db">nodePort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> NODEPORT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5601</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, populate the <code>beats-values.yaml</code> document. Paste the following into the
<code>pipeline/beats-values.yaml</code> file:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">pipeline/beats-values.yaml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">eck-beats</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">fullnameOverride</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> metricbeat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 8.9.0</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">SNAPSHOT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">elasticsearchRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">kibanaRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">daemonSet</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">podTemplate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">args</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> /etc/beat.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system.hostfs=/hostfs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> metricbeat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>🤔 How does the run script work?</summary><div><div class="collapsibleContent_i85q">Take a look at the file you have just created and see how the principles and structures introduced above are applied.<p>On line 11 and 15 the script is downloading a specific version of ECK rather than using a mutable tag like <code>latest</code>. This means that no matter how frequently this image runs, it will always generate the same output.</p><p>In addition, on line 34 the files that should be deployed to the cluster are copied to <code>/output</code>. You may wonder why these files were not downloaded and created directly to the <code>output</code> directory. This is an good practice that allows you to use a temporary directory to download and possibly manipulate files before finalising them in the <code>output</code> directory.</p><p>Finally, you can see that on lines 6 and 7 the script is capturing values from the Resource Request and using those values to customise the outputs. Specifically, it is using the Resource Request name to make sure that the resources have unique names, and using the user provided API value to decide on line 45 if Beats should be installed.</p></div></div></details><p>Your shell script is nearly testable as is. However one complication is the manipulation of the root file system. Therefore, the next step will be to package this script into a Dockerfile which will enable testing and also make it ready for use in your Kratix pipeline.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>Remember there is no limitation to the languages you use in this script. You may prefer more complete programming and scripting languages like Golang, Python, or Elixir as your logic becomes more robust.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="write-the-dockerfile">Write the Dockerfile<a href="#write-the-dockerfile" class="hash-link" aria-label="Direct link to Write the Dockerfile" title="Direct link to Write the Dockerfile">​</a></h3><p>A <a href="https://docs.docker.com/engine/reference/builder/" target="_blank" rel="noopener noreferrer">Dockerfile</a> manages both build and runtime requirements for your container.</p><p>To create your Dockerfile in the pipeline directory run the following command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">touch</span><span class="token plain"> pipeline/Dockerfile</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, paste the contents below into the newly created <code>pipeline/Dockerfile</code>:</p><div class="language-docker codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-docker codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token instruction keyword" style="color:#00009f">FROM</span><span class="token instruction"> </span><span class="token instruction string" style="color:#e3116c">&quot;alpine&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">WORKDIR</span><span class="token instruction"> /pipeline</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">RUN</span><span class="token instruction"> apk update &amp;&amp; apk add --no-cache bash curl openssl yq</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">RUN</span><span class="token instruction"> curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 </span><span class="token instruction operator" style="color:#393A34">\</span><span class="token instruction"></span><br></span><span class="token-line" style="color:#393A34"><span class="token instruction">    &amp;&amp; chmod +x get_helm.sh &amp;&amp; ./get_helm.sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">ADD</span><span class="token instruction"> run /pipeline/run</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">ADD</span><span class="token instruction"> beats-values.yaml /pipeline/beats-values.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">ADD</span><span class="token instruction"> default-config.yaml /pipeline/default-config.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">RUN</span><span class="token instruction"> chmod +x /pipeline/run</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">CMD</span><span class="token instruction"> [ </span><span class="token instruction string" style="color:#e3116c">&quot;sh&quot;</span><span class="token instruction">, </span><span class="token instruction string" style="color:#e3116c">&quot;-c&quot;</span><span class="token instruction">, </span><span class="token instruction string" style="color:#e3116c">&quot;/pipeline/run&quot;</span><span class="token instruction"> ]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">ENTRYPOINT</span><span class="token instruction"> []</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>At this stage, your <code>elastic-cloud-promise</code> directory should look like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">📂 elastic-cloud-promise</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── pipeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── Dockerfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── beats-values.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── default-config.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── promise.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── resource-request.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>🤔 How does the Dockerfile work?</summary><div><div class="collapsibleContent_i85q"><p>Take a look at the created file and you can see on line 1 that this is an Alpine
Linux container that requires <code>bash</code>, <code>curl</code> and <code>yq</code> to be installed on line 4.
This allows you to install Helm on line 5 before calling your <code>run</code> script on
each run via the <code>CMD</code> declaration on line 14 after adding to the image on line
9.</p></div></div></details><h2 class="anchor anchorWithStickyNavbar_LWe7" id="test-the-pipeline">Test the pipeline<a href="#test-the-pipeline" class="hash-link" aria-label="Direct link to Test the pipeline" title="Direct link to Test the pipeline">​</a></h2><p>Now that the script is packaged as a Dockerfile, you are able to run the script without impacting your local root directory.</p><p>In order run a test you will need to:</p><ul><li>Mimic the <code>/output</code> directory locally</li><li>Provide the expected input files (the Resource Request)</li><li>Build the image</li><li>Run the container</li><li>Validate the files in the <code>output</code> directory</li></ul><p>Start by creating the files and test structure:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p test/{input,output}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As an example input, copy the Resource Request as <code>object.yaml</code> into the <code>input</code>
directory:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> resource-request.yaml test/input/object.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>At this stage, your direcory structure should look like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">📂 elastic-cloud-promise</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── pipeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── Dockerfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── beats-values.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── default-config.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── promise.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── resource-request.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── input</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   └── object.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── output</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-simple-test-suite">Create simple test suite<a href="#create-simple-test-suite" class="hash-link" aria-label="Direct link to Create simple test suite" title="Direct link to Create simple test suite">​</a></h3><p>Now that you have your local directories all set up, it is time to actually
build, run and validate the image outputs.</p><p>Here is where another convenience script can be helpful. By creating a build
and test script you will be able to consistently run the necessary commands
and expand on them as you may want to automate more of your testing.</p><p>Use the following command to once again set up the necessary local file structure:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> -p scripts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">touch</span><span class="token plain"> scripts/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">build-pipeline,test-pipeline</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> +x scripts/*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Paste the following in <code>scripts/build-pipeline</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">scripts/build-pipeline</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token shebang important">#!/usr/bin/env bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">set</span><span class="token plain"> -eu -o pipefail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">testdir</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable builtin class-name" style="color:#36acaa">cd</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable string" style="color:#e3116c">&quot;</span><span class="token variable string variable" style="color:#36acaa">$(</span><span class="token variable string variable function" style="color:#d73a49">dirname</span><span class="token variable string variable" style="color:#36acaa"> </span><span class="token variable string variable string" style="color:#e3116c">&quot;</span><span class="token variable string variable string variable" style="color:#36acaa">$0</span><span class="token variable string variable string" style="color:#e3116c">&quot;</span><span class="token variable string variable" style="color:#36acaa">)</span><span class="token variable string" style="color:#e3116c">&quot;</span><span class="token variable" style="color:#36acaa">/</span><span class="token variable punctuation" style="color:#393A34">..</span><span class="token variable" style="color:#36acaa">/test</span><span class="token variable punctuation" style="color:#393A34">;</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable builtin class-name" style="color:#36acaa">pwd</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> build --tag kratix-workshop/elastic-pipeline:dev </span><span class="token variable" style="color:#36acaa">$testdir</span><span class="token plain">/</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">/pipeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind load docker-image --name platform kratix-workshop/elastic-pipeline:dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Paste the following in <code>scripts/test-pipeline</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">scripts/test-pipeline</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token shebang important">#!/usr/bin/env bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">scriptsdir</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable builtin class-name" style="color:#36acaa">cd</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable string" style="color:#e3116c">&quot;</span><span class="token variable string variable" style="color:#36acaa">$(</span><span class="token variable string variable function" style="color:#d73a49">dirname</span><span class="token variable string variable" style="color:#36acaa"> </span><span class="token variable string variable string" style="color:#e3116c">&quot;</span><span class="token variable string variable string variable" style="color:#36acaa">$0</span><span class="token variable string variable string" style="color:#e3116c">&quot;</span><span class="token variable string variable" style="color:#36acaa">)</span><span class="token variable string" style="color:#e3116c">&quot;</span><span class="token variable punctuation" style="color:#393A34">;</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable builtin class-name" style="color:#36acaa">pwd</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">testdir</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable builtin class-name" style="color:#36acaa">cd</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable string" style="color:#e3116c">&quot;</span><span class="token variable string variable" style="color:#36acaa">$(</span><span class="token variable string variable function" style="color:#d73a49">dirname</span><span class="token variable string variable" style="color:#36acaa"> </span><span class="token variable string variable string" style="color:#e3116c">&quot;</span><span class="token variable string variable string variable" style="color:#36acaa">$0</span><span class="token variable string variable string" style="color:#e3116c">&quot;</span><span class="token variable string variable" style="color:#36acaa">)</span><span class="token variable string" style="color:#e3116c">&quot;</span><span class="token variable" style="color:#36acaa">/</span><span class="token variable punctuation" style="color:#393A34">..</span><span class="token variable" style="color:#36acaa">/test</span><span class="token variable punctuation" style="color:#393A34">;</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable builtin class-name" style="color:#36acaa">pwd</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">inputDir</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$testdir</span><span class="token string" style="color:#e3116c">/input&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">outputDir</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$testdir</span><span class="token string" style="color:#e3116c">/output&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$scriptsdir</span><span class="token plain">/build-pipeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">rm</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$outputDir</span><span class="token plain">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run --rm --volume </span><span class="token variable" style="color:#36acaa">${outputDir}</span><span class="token plain">:/output --volume </span><span class="token variable" style="color:#36acaa">${inputDir}</span><span class="token plain">:/input kratix-workshop/elastic-pipeline:dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>These scripts do the following:</p><ul><li><code>build-pipeline</code> codifies the dev tag for the image and how to build it. It
will also load the container image on the KinD cluster.</li><li><code>test-pipeline</code> calls build-pipeline and also runs the pipeline image,
allowing you to verify the created files in the <code>test/output</code> directory.</li></ul><p>At this stage, your directory structure should look like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">📂 elastic-cloud-promise</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── pipeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── Dockerfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── beats-values.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── default-config.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── promise.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── resource-request.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── scripts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── build-pipeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── test-pipeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── input</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   └── object.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── output</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-the-test">Run the test<a href="#run-the-test" class="hash-link" aria-label="Direct link to Run the test" title="Direct link to Run the test">​</a></h3><p>To execute the test, run the script with the following command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./scripts/test-pipeline</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Which should build and run the Pipeline image. Once the execution completes,
verify the <code>test/output</code> directory. You should see the following files:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">📂 elastic-cloud-promise</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── input</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   └── object.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ├── beats.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ├── elastic-crds.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ├── elastic-operator.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ├── elasticsearch.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        └── kibana.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can take a look at the files and verify their contents. If everything looks
good, your pipeline image is ready to be included in your promise.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Testing pipeline images</div><div class="admonitionContent_S0QG"><p>As you just experience, testing pipeline images is really simple. You can
quickly validate that the pipeline is outputting exactly what you want, without
even touching Kubernetes.</p><p>The ability to treat pipeline image as independent pieces of software that can
have their own development lifecycle (fully testable, easy to execute locally,
release independent) allows platform teams to move faster, sharing and reusing
images across their Promises.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="add-container-to-pipeline">Include this container in your Promise pipeline<a href="#add-container-to-pipeline" class="hash-link" aria-label="Direct link to Include this container in your Promise pipeline" title="Direct link to Include this container in your Promise pipeline">​</a></h2><p>With your pipeline tested you are ready to add it to your Promise. To do this,
you will add a new top level key in the Promise <code>spec</code> as a sibling to the
<code>xaasCrd</code> key you created in the last section.</p><p>The key should be <code>xaasRequestPipeline</code> and should contain a list of your
pipelines containers which will be just one for now:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">promise.yaml -- include it under the &#x27;spec&#x27; key</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">xaasRequestPipeline</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> kratix</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">workshop/elastic</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="install-promise">Install the Promise<a href="#install-promise" class="hash-link" aria-label="Direct link to Install the Promise" title="Direct link to Install the Promise">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisite-setup">Prerequisite setup<a href="#prerequisite-setup" class="hash-link" aria-label="Direct link to Prerequisite setup" title="Direct link to Prerequisite setup">​</a></h3><p>Following the previous step of this tutorial, you should now
have a deployment of both Kratix and MinIO running on your Platform cluster
with no installed Promises.</p><p>You should also have two environment variables, <code>PLATFORM</code> and <code>WORKER</code>.</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Verify the current state of your installation</summary><div><div class="collapsibleContent_i85q">Run:<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$PLATFORM</span><span class="token plain"> get deployments --namespace kratix-platform-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The above command will give an output similar to:</p><div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token output">NAME                                 READY   UP-TO-DATE   AVAILABLE   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">kratix-platform-controller-manager   1/1     1            1           1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">minio                                1/1     1            1           1h</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You should also have a State Store created and configured to point to the
<code>kratix</code> bucket on MinIO. Verify the <code>bucketstatestores</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$PLATFORM</span><span class="token plain"> get bucketstatestores.platform.kratix.io</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The above command will give an output similar to:</p><div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token output">NAME          AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">minio-store   1h</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Verify there are no existing Promises:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$PLATFORM</span><span class="token plain"> get promises</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Verify your cluster environment variables are set:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">env</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;PLATFORM\|WORKER&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>which should result in:</p><div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token output">WORKER=kind-worker</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">PLATFORM=kind-platform</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><p>If you are are not continuing from the previous section, or your outputs do not align with the validation, please refer back to
<a href="/docs/workshop/installing-kratix">Installing Kratix</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-the-promise">Install the Promise<a href="#install-the-promise" class="hash-link" aria-label="Direct link to Install the Promise" title="Direct link to Install the Promise">​</a></h3><p>You can now install the updated Promise:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$PLATFORM</span><span class="token plain"> create --filename promise.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To validate the Promise has been installed, you can list all Promises by running:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context kind-platform get promises</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Your output will show the <code>elastic-cloud</code> Promise:</p><div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token output">NAME            AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">elastic-cloud   10s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="request-instance">Request an on-demand instance of your Promise<a href="#request-instance" class="hash-link" aria-label="Direct link to Request an on-demand instance of your Promise" title="Direct link to Request an on-demand instance of your Promise">​</a></h2><p>Now that the Promise is installed and includes a pipeline to provision the ECK resources, you can switch hats to act like an application engineer who wants to request an instance of a monitoring stack.</p><p>The request will result in the pipeline&#x27;s output being installed on the worker cluster:</p><figure class="diagram"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 870.496 145.505" class="large"><defs><style>@font-face{font-family:&quot;Virgil&quot;;src:url(https://excalidraw.com/Virgil.woff2)}@font-face{font-family:&quot;Cascadia&quot;;src:url(https://excalidraw.com/Cascadia.woff2)}</style></defs><path fill="#fff" d="M0 0h870.496v145.505H0z"></path><g stroke-opacity="0.5" fill-opacity="0.5" fill-rule="evenodd" stroke-linecap="round"><path d="M604.98 16.076s0 0 0 0m0 0s0 0 0 0m-10.38-3.01c7.11 4.35 12.76 11.74 15.85 12.26m-14.04-12.79c4.4 6.59 10.92 10.87 14.49 14.08m-20.24-13.8c6.87 8.94 15.56 14.2 28.16 27.45m-29.32-27.02c9.59 7.21 17.34 14.73 29.32 25.89m-34.93-25.1c14.4 11.6 26.42 23.24 40.29 35.59m-39.99-36.65c13.06 11.66 26.67 23.02 39.08 36.08m-45.55-37.14c10.77 10.46 18.84 19.44 48.18 42.54m-48.51-40.73c12.65 9.94 22.47 19.64 47.36 39.77m-55.11-40.24c20.45 18.77 42.36 33.83 55.18 45.23m-52.53-45.12c16.38 14.82 36.16 32.24 52.3 46.87m-60.27-46.44c14.69 12.87 28.61 21.32 58.35 48.65m-56.26-48.09c15.98 14.01 31.57 26.93 55.93 47.93m-61.72-47.26c10.88 11.32 25.44 21.47 61.4 52.2m-63.54-54.28c24.27 23.01 49.09 42.79 64.05 55.62m-70.6-55.76c20.3 18.22 43.11 37.63 67.3 60.65m-65.49-60.22c15.78 15.64 32.58 29.54 67.9 58.62m-72.65-58.34c18.78 19.69 38.44 34.41 71.58 63.95m-73.97-63.76c27.76 22.74 53.88 45.53 72.43 62.43m-78.35-64.02c24.39 19.94 50.41 41.92 78.84 69.92m-79.14-69.33c22.93 18.37 43.06 38.58 77.84 69.09m-81.88-66.97c24.13 19.13 47.82 40.53 81.78 71.63m-82.59-72.98c27.4 24.47 55.91 49.26 83.53 73.56m-88.21-73.15c27.88 25.49 53.9 51.32 86.33 76.75m-87.59-76.2c17.58 14.98 35.14 30.69 88.36 76.03m-94.28-75.52c22.09 19.02 46.3 38.8 91.04 78.12m-90.53-78.21c26.93 22.87 53.51 45.91 90.92 79.53m-99.2-82.58c28.39 23.51 53.93 49.81 99.55 86.49m-98.51-85.22c37.77 33.36 76.02 66.93 97.03 85.66m-105.36-85.61c42.84 34.71 79.12 68.26 104.49 87.2m-103.33-86.73c40.05 34.36 79.4 68.69 102.71 88.25m-108.82-89.36c30.04 29.07 61.79 53.98 106.84 90.82m-105.95-88.77c26.22 21.97 49.94 42.89 104.44 89.06m-110.52-91.11c28.72 26.64 58.3 52.51 105.67 94.44m-106.31-92.73c31.41 25.4 62.55 53.17 107.95 91.94m-111.39-92.71c36.38 34.23 77.86 68.26 107.8 96.39m-110.1-96.76c30.25 26.24 61.13 53.96 110.91 96.73m-115.3-95.7c35.04 30.58 70.5 60.9 110.43 98.26m-111.46-99.33c28.47 24.12 55.97 47.55 112.49 100.13M482 12.396c29.85 28.79 62.17 55.06 113.49 101.52M481.01 13.486c34.52 30.91 69.35 60.75 114.81 99.39m-.3.98s0 0 0 0m0 0s0 0 0 0M473.45 12.306c33.3 27.97 66.24 54.41 115.48 101.59M474.99 13.226c31.21 29.59 63.84 57.24 115.41 101.33M469.8 14.006c23.57 22.66 49.8 44.04 113.92 101.46m-115.91-101.6c38.53 35.4 78.85 69.56 115.31 100.9M460.68 14.186c24.45 19.36 47.12 39.23 115.36 100.89M462.78 14.206c40 36.18 83.1 73.35 114.6 100.18M456.47 13.676c36.77 34.27 78.23 68.25 114.59 100.78M456.84 14.276c31.71 27.69 64.6 56.28 114.02 100.17m-118.9-98.99c39.2 35.8 84.84 73.43 112.72 98.04m-114.06-99.39c30.95 29.48 65.42 58.23 114.72 100.46M445.41 13.516c35.77 30.39 69.12 60.51 114.4 101.34m-116.44-100c31.58 27.03 62.62 53.87 116.63 100.15M438.83 13.486c32.2 30.49 66.69 58.13 114.63 99.37m-115.28-99.88c27.21 23.9 53.33 47.19 114.1 100.89m-119.43-101.1c41.72 39.14 87.94 77.31 112.18 101.31M432.7 14.596c25.22 23.46 52.91 46.47 114.48 98.62m-119.71-98.66c38.94 32.7 76.26 68.89 111.68 98.89M424.89 13.126c38.92 33.52 74.29 66.04 115.08 100.38m-119.53-98.93c24.66 22.06 51.18 47.15 114.01 97.83m-115.27-98.14c34.66 31.05 67.96 60.7 114.66 98.87m-121.6-97.29c31.48 24.24 62.09 47.38 117.69 97.61M412.5 14.216c36.24 31.99 71.98 61.56 115.73 99.28m-119.75-98.14c28.66 26.41 63.59 55.59 113.47 99.72m-115.5-102.29c35.57 30.97 71.07 62.13 116.26 100.37m-122.06-99.03c35.11 30.26 67.85 57.35 113.97 100.19m-113.56-99.47c36.25 28.28 70.88 58.64 114.15 98.14m-118.27-99.61c37.86 35.67 79.22 70.26 111.63 99.51M395.45 12.846c29.5 27.34 59.77 54.76 114.35 100.75m-119.21-98.52c26.6 23.62 55.79 47.61 113.14 98.25m-114.59-98.43c31.32 26.98 64.14 53.36 114.18 99m-120.41-99.04c25.48 21.01 52.52 42.78 116.82 100.69M382.92 13.956c34.64 29.73 66.55 58.78 115.76 101.14m-122.29-99.84c28.51 24.27 52.57 44.56 114.5 98.48m-114-99.16c35.28 30.06 70.82 61.6 114.89 99.4m-122.09-99.41c32.83 28.21 65.33 57.23 116.86 98.42m-115.16-98.9c33.08 28.39 68.14 58.61 113.35 98.83m-118.72-97.43c32.85 27.84 67.34 59.59 115.89 97.87m-117.68-98.65c41.14 35 82.47 70.25 116.39 99.72M359.93 13.206c31.3 27.29 59.84 54.26 114.85 98.83m-115.35-98.04c31.54 28.2 64.11 55.94 113.7 100.61M354.11 13.486c28.4 23.26 55.59 47.82 113.87 100.43m-115.09-99.52c34.28 31.52 70.36 62.76 115.99 99.84m-123.15-98.88c36.97 31.02 74.79 66.72 116.6 99.1m-115.65-100.2c29.47 25.95 60.05 51.85 114.64 98.76m-121.87-99.14c40.42 33.53 83.41 67.79 115.53 100.48M340.91 14.066c35.31 32.29 70.3 63.07 114.03 100.5m-121.13-99.71c42.13 31.46 81.59 67.21 114.45 98.73M334.05 13.556c38.68 32.25 75.81 63.6 115.01 100.42M329.98 12.866c27.99 28.94 59.25 56.68 114.45 102.67M328.59 15.106c25.45 22.99 52.35 45.54 113.87 99.19m-119.88-98.87c31.4 26.01 61.5 50.83 115.47 100.22M321.78 14.356c40.72 36.57 83.28 72.83 114.89 100.24m-120.63-99.04c42.45 35.04 87.77 75.23 114.97 98.67M316.82 14.186c23.8 21.67 48.41 41.26 114.07 98.99m-119.3-100.47c30.82 30.35 66.85 59.59 113.24 100.41m-114.96-99.15c41.45 37.75 82.48 72.86 115.37 99.67m-121.6-100.33c43.23 37 82.55 71.36 115.89 102.46M303.24 13.626c35.18 29.46 70.77 59.86 116.23 99.76m-120.92-98.46c35.89 29.79 72.02 63.29 115.83 98.42m-116.24-99.22c34.78 32.07 70.1 63.06 114.54 98.99M291.45 12.346c27.74 23.57 56.8 48.68 114.8 103.06m-113.91-102.4c27.34 25.69 55.77 49.65 115.18 100.9m-122.96-97.7c43.24 34.38 85.93 71.94 114.09 96.44m-112.19-99.26c31.63 29.02 64.42 57.28 113.72 100m-119.91-97.54c44.63 36.92 90.95 75.83 115.79 99.79M279.87 14.246c32.74 29.01 66.13 57.73 114.74 98.61m-122.45-98.28c29.97 25.53 57.58 49.08 116.58 98.28m-115.02-98.77c40.67 35.19 79.71 70.72 114.52 100.66M266.08 12.526c35.82 31.32 71.6 62.83 117.43 102.31M266.88 13.196c39.8 36.2 78.53 70.58 115.78 99.93M262.5 13.296c36.99 33.33 75.85 67 113.64 101.45m-116-100.04c32.73 26.5 64.17 54.24 116.76 99.08m-119.63-99.75c41.9 39.44 83.48 76.37 113.04 99.27m-114.34-99.27c31.59 25.44 62.02 52.7 114.37 99.4m-121.9-99.9c27.61 24.64 53.57 44.04 113.57 101.8m-112.8-101.85c27.13 25.81 55.47 48.81 114.78 100.28M244.61 12.916c39.86 36.44 83.74 74.96 113.71 101.01m-114.01-99.71c40.89 37.38 81.14 72.14 112.83 99.74M235.96 12.386c29.18 25.71 55.92 51.06 114.23 100.11m-113.95-98.98c33.38 29.55 67.24 58.13 114.91 100.66M231.3 12.606c39 36.45 80.95 70.94 115.51 102.86m-116.24-99.97c28.88 24.91 58.2 50.4 115.03 99.15m-118.14-97.19c38.59 31.47 76.28 64.07 113.17 97.61m-114.04-98.78c31.98 28.95 63.63 57.5 113.72 97.57m-117.6-97.09c36.16 34.42 74.36 65.18 110.99 97.2m-109.91-95.76c26.01 23.37 54.18 47.26 109.75 95.42m-115.05-93.31c44.11 39.55 87.05 74.36 107.98 95.1m-107.08-95.29c40.45 35.96 82.45 71.11 108.32 94.47m-112.37-91.28c24.14 18.92 51.87 42.18 105.25 92m-103.35-92.94c39.52 37.14 80.63 73.11 104.85 92.38m-108.07-90.33c30.97 30.32 65.64 59.36 101.23 90.43m-100.41-87.7c30.18 26.16 61.66 52.86 101.26 86.32m-103.26-81.68c35.12 28.19 65.93 56.28 97.37 81.56m-96.7-83.35c31.69 29.77 65.33 57.55 94.67 84.73m-98.52-80.23c33 29.78 71.1 58.77 92.48 78.42m-91.73-79.29c29.08 23.54 55.81 48.1 92.66 79.58m-96.56-77.27c23.08 20.26 45.29 41.61 88.94 78.56m-87.48-77.79c28.94 26.72 59.32 51.58 88.56 78.02m-90.12-71.57c18.88 16.37 37.49 31.96 84.61 68.87m-82.38-70.4c18.06 15.8 36.09 30.88 82.35 72.17m-84.38-67.42c24.4 18.79 43.31 38.27 78.01 68.67m-77.55-69.67c17.46 17.23 35.1 32.42 78.82 69.3m-79.67-64.43c19.4 16.68 36.52 33.61 73.65 65.29m-74.26-64.24c29.87 24.34 57.16 47.24 73.92 62.27m-73.04-57.55c17.16 14.6 34.31 31.07 64.17 58.55m-65.13-58c16.96 13.34 35.42 28.94 65.81 57.12m-64.44-51.48c15.45 13.26 33.77 28.86 58.97 50.17m-60.92-51.06c20.93 15.75 40.79 34.03 62.68 53.46m-63.44-46.12c15.93 10.24 29.52 18.68 56.02 43.83m-53.35-46.37c13.68 12.75 30.31 26.29 53.38 47.48m-53.04-40.92c16.5 12.25 31.46 28.74 47.36 41.67m-48.74-41.91c13.36 11.31 24.37 21.49 48 41.56m-46.91-34.34c13.14 6.67 23.21 19.02 40.11 34.52m-40.11-35.38c13.62 10.02 25.96 21.28 41.84 35.31m-40.5-29.51c12.03 10.26 22.55 21 32.94 28.95m-35.75-30.95c15.23 11.83 27.68 25.18 36.96 31.84m-.6-.67s0 0 0 0m0 0s0 0 0 0m-33.56-23.36c8.08 5.82 15.08 13.92 29.02 24.12m-28.56-24.4c6.39 7.25 14.09 11.05 26.41 23.05" stroke="#b2f2bb" stroke-width="0.5" fill="none"></path><path d="M591.81 12.816c-52.63.05-257.29 0-316.25-.31-58.96-.31-28.66-2.29-37.48-1.54-8.83.76-10.65 2-15.47 6.07s-10.5 10.23-13.45 18.37c-2.94 8.14-4.99 20.51-4.23 30.47.75 9.96 4.8 21.84 8.77 29.29 3.97 7.45 10.34 12.35 15.05 15.44 4.72 3.09 6.39 2.79 13.26 3.07 6.88.29-25.73-1.39 28-1.38 53.73.01 240.73 1.29 294.35 1.46 53.63.17 19.98.84 27.41-.44s12.77-3.55 17.19-7.24c4.42-3.69 6.7-7.31 9.33-14.9 2.63-7.58 5.96-21.43 6.44-30.61.47-9.17-.42-16.94-3.59-24.43-3.16-7.49-10.48-16.41-15.38-20.5-4.9-4.08-11.58-3.48-14.03-4.01-2.45-.53-.79 1.01-.69.84m1.99-.57c-52.76-.11-259.81-.39-318.64-.13-58.83.25-26.1.74-34.36 1.66-8.26.92-9.91.43-15.19 3.87-5.29 3.43-13.3 8.42-16.54 16.75-3.23 8.33-3.49 22.94-2.87 33.23.62 10.28 2.59 21.45 6.58 28.48 4 7.03 12.71 10.92 17.39 13.69 4.67 2.76 3.85 2.38 10.66 2.88 6.81.51-24.26-.18 30.19.17 54.45.34 242.92 1.93 296.49 1.9 53.57-.03 17.71-.76 24.94-2.11 7.23-1.34 13.9-2.85 18.45-5.97 4.55-3.13 6.36-5.17 8.87-12.78 2.51-7.61 5.98-23.49 6.2-32.86.22-9.38-1.6-16.22-4.9-23.37-3.3-7.15-10.1-15.02-14.92-19.52-4.81-4.51-11.52-6.44-13.99-7.5-2.48-1.05-.76 1.12-.85 1.16" stroke="#087f5b" fill="none"></path></g><path d="M322.555 12.413c-1.82.12-8.04-.86-11.27 1.37-3.24 2.24-5.91 7.53-8.15 12.05-2.23 4.52-4.28 8.73-5.26 15.09-.97 6.36-1.39 14.71-.58 23.09.8 8.38 2.67 20.01 5.39 27.17 2.73 7.15 7.47 12.42 10.96 15.75 3.49 3.33 8.47 3.82 9.96 4.24m-3.3-100.02c-1.51.41-4.76 2.59-7.29 4.91-2.52 2.32-5.69 4.81-7.86 9.01-2.18 4.2-4.34 9.97-5.19 16.21-.86 6.24-.07 12.7.06 21.24.12 8.54-1.27 22.53.67 30.01 1.94 7.49 7.01 11.91 10.94 14.9 3.93 2.99 10.62 2.46 12.64 3.04M406.999 11.332c-1.38.28-5.86-.34-8.29 2.24-2.44 2.57-4.83 8.68-6.3 13.22-1.47 4.55-1.86 8.06-2.53 14.04-.66 5.99-1.73 13.66-1.49 21.87.25 8.2.77 20.19 2.96 27.36 2.19 7.17 7.14 12.51 10.17 15.68 3.04 3.17 6.86 2.53 8.04 3.34m-1.88-95.86c-1.01.66-5.21.33-7.43 2.56-2.23 2.24-4.06 6.59-5.91 10.84-1.85 4.24-4.1 8.34-5.2 14.62-1.09 6.28-1.91 14.78-1.37 23.07.54 8.29 2.62 19.77 4.6 26.69 1.98 6.92 4.29 11.46 7.29 14.82 3.01 3.36 9.03 4.76 10.74 5.32M513.995 12.483c-1.48.24-5.59.38-7.92 2.89-2.34 2.52-4.36 7.77-6.1 12.18-1.73 4.41-3.36 8.25-4.32 14.27-.97 6.01-1.81 13.29-1.46 21.83.34 8.53 1.53 21.95 3.52 29.37 1.99 7.41 5.69 12.29 8.43 15.12 2.74 2.83 6.54 1.37 8.01 1.85m.91-95.52c-1.77-.01-7.84-2.22-10.52-.09-2.69 2.14-3.96 8.25-5.61 12.89-1.64 4.65-3.34 8.64-4.28 14.97-.93 6.33-2.01 14.83-1.32 23.01.69 8.19 3.17 18.81 5.46 26.1 2.29 7.29 5.74 14.18 8.3 17.63 2.55 3.44 5.48 2.39 7.03 3.04M600.465 11.343c-1.53.37-5.33.97-7.77 3.43-2.45 2.47-5.05 7.04-6.88 11.36-1.84 4.33-3.76 8.31-4.14 14.61-.38 6.3 1.22 14.84 1.85 23.2.63 8.37.06 19.72 1.94 27 1.87 7.29 6.61 13.67 9.32 16.74 2.7 3.07 5.8 1.1 6.92 1.66m-.58-96.24c-1.25.18-4.4-1.33-6.64.74-2.24 2.06-5 7.12-6.8 11.64-1.8 4.52-3.34 9.33-3.99 15.48-.66 6.16.16 12.91.07 21.46-.09 8.54-2.13 22.09-.62 29.8 1.5 7.7 6.53 13.23 9.65 16.42 3.11 3.2 7.4 2.59 9.04 2.77" stroke="#087f5b" fill="none" stroke-linecap="round"></path><g mask="url(#mask-igj1dKExd5gtrFBx0EVBH)" stroke-linecap="round"><path d="M68.595 65.442c9.29-.04 34.02-.24 55.71-.24 21.7 0 62.07.2 74.48.24m-130.19 0c9.29-.04 34.02-.24 55.71-.24 21.7 0 62.07.2 74.48.24M170.555 75.592c10.58-3.8 21.16-7.61 28.23-10.15m-28.23 10.15c8.05-2.89 16.1-5.79 28.23-10.15" stroke="#2f9e44" stroke-width="4" fill="none"></path><path d="M170.635 55.072c10.55 3.89 21.1 7.77 28.15 10.37m-28.15-10.37c8.02 2.96 16.05 5.91 28.15 10.37" stroke="#2f9e44" stroke-width="4" fill="none"></path></g><mask id="mask-igj1dKExd5gtrFBx0EVBH"><path fill="#fff" d="M0 0h298.784v165.678H0z"></path><path d="M94.341 55.206h59.936v20H94.341z"></path></mask><text x="29.968" font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#2f9e44" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(94.34 55.206)">request</text><text font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#1e1e1e" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(214.997 54.212)">transform</text><text font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#1e1e1e" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(520.198 55.075)">notify</text><text x="32.16" font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#1e1e1e" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(311.55 33.205)">validate</text><text x="32.16" y="20" font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#1e1e1e" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(311.55 33.205)">secure</text><text x="32.16" y="40" font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#1e1e1e" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(311.55 33.205)">scan</text><text x="38.776" font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#1e1e1e" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(405.472 45.806)">billing</text><text x="38.776" y="20" font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#1e1e1e" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(405.472 45.806)">compliance</text><g mask="url(#mask-rhLsx3B3GVveE0L1Vk06m)" stroke-linecap="round"><path d="M631.582 68.567c22.18-.11 110.92-.56 133.11-.68m-133.11.68c22.18-.11 110.92-.56 133.11-.68M736.552 78.297c9.48-3.51 18.96-7.01 28.14-10.41m-28.14 10.41c10.77-3.99 21.55-7.97 28.14-10.41" stroke="#1971c2" stroke-width="4" fill="none"></path><path d="M736.442 57.777c9.52 3.41 19.04 6.82 28.25 10.11m-28.25-10.11c10.82 3.87 21.63 7.75 28.25 10.11" stroke="#1971c2" stroke-width="4" fill="none"></path></g><mask id="mask-rhLsx3B3GVveE0L1Vk06m"><path fill="#fff" d="M0 0h864.687v169.243H0z"></path><path d="M671.631 58.229h53.008v20h-53.008z"></path></mask><text x="26.504" font-family="Virgil, Segoe UI Emoji" font-size="16" fill="#1971c2" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(671.63 58.229)">output</text><g stroke-linecap="round"><path d="m790.757 28.944 70.64-2.51.6 111.01-72.4-3.69" stroke-width="0" fill="#fff"></path><path d="M789.197 28.524c28.61-.65 54.9-.44 72.22-1.85m-71.03 1.63c23.24-.65 46.8.91 69.54-.07m.89-.44c-1.41 36.53-.36 69.12-1.77 107.61m.98-106.69c-.61 21.64.28 44.49.89 105.83m-.04 1.94c-16.44-.53-33.94-2.44-72.7-1.33m72.04 1.33c-27.65-.49-54.49-.43-70.62-.59m-.1-.14c1.09-32.09-.54-64.3-.49-108.78m.7 107.86c.75-41.65-.71-84.09.26-106.52" stroke="#1971c2" stroke-width="2" fill="none"></path></g><g stroke-linecap="round"><path d="m783.17 19.414 71.28 3.76-1.73 103.56-68.78 1.9" stroke-width="0" fill="#fff"></path><path d="M782.34 20.874c19.71.11 43.51-1.31 71.31 2.29m-71.26-2.65c19.88 1.53 39.34.67 70.78.53m-1.1 1.76c1.22 21.3-.4 44.77-1 104.22m1.58-105.81c.39 29.24.22 56.1-.28 107.49m1.64.64c-17.55-1.57-37.06-.87-69.86-.34m68.73-.58c-25.64.76-53.46 1.14-70.6-.84m-.21 1.3c-1.46-35.45-.43-72.66 2.12-107.82m-1.37 107.55c-1.34-31.23-.28-62.55-.08-107.04" stroke="#1971c2" stroke-width="2" fill="none"></path></g><g stroke-linecap="round"><path d="m774.375 14.92 68.95-3.69 1.9 109.15-71.14-.89" stroke-width="0" fill="#fff"></path><path d="M771.325 12.82c24.61-1.29 46.54 2.22 71.89 1.31m-70.36-.31c21-.35 43.34-.53 69.86-.68m1-.52c-2.08 29.95-2.51 58.28-.84 106.67m1.27-105.61c-.49 35.5-1.49 73.84-1.16 106.74m1.26-1.25c-26.98 1.01-48.11 1.88-69.83.51m70.09.55c-29.3.35-57.22-.94-71.32-.16m-2.14.6c1.13-35.21 3.85-67.58 1.66-107.92m-.74 107.62c.47-25.11.79-49.86 1.36-108.3" stroke="#1971c2" stroke-width="2" fill="none"></path></g><path d="M784.771 62.278c6.61.25 31.6.67 39.57.03 7.97-.64 6.96-3.27 8.26-3.87m-49.34 3.09c7-.04 35.1-.81 43.29-1.12 8.2-.31 4.86-.67 5.89-.76M785.767 30.682c3.02-.59 11.08-3.31 18.94-3.43 7.87-.11 23.65 2.44 28.26 2.74m-45.49-.13c2.96-.46 9.38-1.42 16.89-1.17 7.52.24 23.47 2.48 28.2 2.65M787.8 97.457c4.67-.11 19.84-.27 25.94 0 6.1.28 7.13 1.78 10.66 1.65 3.54-.12 8.9-1.83 10.55-2.4m-48-.4c4.66.07 20.08 2.11 26.2 2.72 6.13.61 6.89 1.67 10.56.95 3.67-.73 9.41-4.65 11.48-5.3M784.146 108.96c1.52-.31 7.05-2.11 9.62-2.09 2.57.02-.08 1.76 5.8 2.2 5.88.44 23.04.87 29.47.42 6.42-.45 7.78-2.67 9.09-3.12m-55.08 1.57c1.28-.15 7.22.13 9.84.02 2.63-.12-.11-1.14 5.9-.7 6.01.44 23.8 3.43 30.14 3.33 6.33-.11 6.39-3.16 7.86-3.95M783.88 44.463c2.91.06 10.35.83 18.03 1.28 7.68.45 23.24 1.24 28.08 1.45m-47.49-.57c2.69-.26 10.72-2.78 18.45-2.47 7.73.31 22.85 3.71 27.91 4.34M783.828 80.816c1.21.38 4.35.7 7.43.4 3.08-.31 4.63-2.34 11.04-2.23 6.42.11 22.78 2.54 27.48 2.9m-47.42-1.58c1.59.65 8.03 2.46 11.25 2.44 3.22-.02 2.09-2.63 8.07-2.57 5.98.06 22.67 2.73 27.82 2.91" stroke="#1971c2" fill="none" stroke-linecap="round"></path><g stroke-linecap="round"><path d="m9.56 27.263 51.96 1.55 1.79 78.29-54.64.68" stroke-width="0" fill="#fff"></path><path d="M8.35 26.333c19.31.17 39.76 2.37 55.76 3.32m-54.66-2.21c22.26.29 42.07-.45 54.28 1.13m-1.04-1.33c.42 25.79-.98 48-1.67 80.75m2.32-80.92c.72 29.58.72 59.87-.2 81.76m-.52.46c-16.24-.67-35.37-3.4-51.06-2.11m50.73 1.35c-12.33-.15-25.1-1.07-51.61-.72m-2.5 0c1.18-19.91.74-41.53.02-80.08m1.8 79.98c-.1-19.18-1.5-39.53-.68-79.84" stroke="#2f9e44" stroke-width="2" fill="none"></path></g><path d="M16.7 61.793c5.01.21 24.61 1.33 30.61.96 6-.38 4.56-2.74 5.4-3.2m-34.37 1.17c5.44-.1 25.73.28 31.35.31 5.61.03 1.88.39 2.35-.16M18.534 39.156c2.3-.34 7.63-2.77 13.37-2.86 5.74-.09 17.45 2.23 21.08 2.34m-32.59-.12c2.26-.13 5.37-.35 10.66-.68 5.28-.33 17.21-1.22 21.07-1.28M19.287 88.67c3.36-.08 14.61.21 19.35.3 4.74.09 6.34.68 9.07.25 2.73-.43 6.06-2.45 7.31-2.83m-37.09 1.24c3.24-.51 14.78-.9 19.67-.52 4.88.38 6.7 2.81 9.63 2.81 2.93-.01 6.86-2.4 7.95-2.85M16.551 97.55c1.32-.34 6.29-2.22 8.3-2.54 2.01-.32-.65.23 3.76.61 4.4.37 17.94 1.8 22.67 1.63 4.73-.16 4.59-2.37 5.7-2.64m-41.98 2.16c1.19-.24 7.05-.8 9.18-.84 2.13-.04-.98.2 3.58.58 4.56.38 18.58 2.02 23.78 1.71 5.21-.31 6.7-3.03 7.44-3.6M17.474 48.443c2.27-.29 7.13-.46 12.89-.07 5.75.38 18.08 2.07 21.63 2.39m-35.7-.32c2.11-.21 7.21-1.22 13.03-.96 5.83.25 18.19 2.21 21.92 2.46M16.864 74.542c.92.33 4 1.67 6.23 1.61 2.23-.06 2.24-2.13 7.16-1.97 4.92.16 18.81 2.62 22.37 2.92m-37.3-.38c.72.62 4.51 1.1 6.84.83 2.33-.27 1.97-2.58 7.14-2.44 5.17.14 19.83 3.14 23.87 3.27" stroke="#2f9e44" fill="none" stroke-linecap="round"></path></svg><figcaption>An example multi-stage Pipeline</figcaption></figure><h3 class="anchor anchorWithStickyNavbar_LWe7" id="send-a-resource-request">Send a Resource Request<a href="#send-a-resource-request" class="hash-link" aria-label="Direct link to Send a Resource Request" title="Direct link to Send a Resource Request">​</a></h3><p>You can use the same Resource Request as in the last section by running:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$PLATFORM</span><span class="token plain"> apply --filename resource-request.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can once again see this request by listing all the request for elastic clouds using the following command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$PLATFORM</span><span class="token plain"> get elastic-cloud</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The above command will give an output similar to:</p><div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token output">NAME      STATUS</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">example   Pending</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As an application engineer, you can see the Status as either <code>Pending</code> meaning that the provisioning is not yet complete, or <code>Resource requested</code> which indicates that the pipeline is complete. This is the basic status provided by Kratix, but you will be able to enhance this experience at a later step in this workshop.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="verify-the-pipeline">Verify the pipeline<a href="#verify-the-pipeline" class="hash-link" aria-label="Direct link to Verify the pipeline" title="Direct link to Verify the pipeline">​</a></h3><p>As a platform engineer you can continue on to verify some of the processes behind the scenes. First of all, you can verify that the pipeline has been triggered by the creation of a Resource Request. To see the pod run:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$PLATFORM</span><span class="token plain"> get pods --show-labels</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The output should look something like this:</p><div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token output">NAME                                           READY   STATUS      RESTARTS   AGE     LABELS</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">request-pipeline-elastic-cloud-default-33029   0/1     Completed   0          1m   kratix-promise-id=elastic-cloud-default...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Within this pod there will be a number of containers including Kratix utility actions and the list of images you provided in the Promise.</p><p>To see the list of these containers in order of execution you can run:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$PLATFORM</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  get pods </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --selector kratix-promise-id</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">elastic-cloud-default </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --output </span><span class="token assign-left variable" style="color:#36acaa">jsonpath</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;{range .items[*].spec.initContainers[*]}{.name}{&#x27;</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">&#x27;}{end}{range .items[*].spec.containers[*]}{.name}{&#x27;</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">&#x27;}{end}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Each container is listed in a row, in order that they occur so you should see:</p><div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token output">reader</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">xaas-request-pipeline-stage-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">work-writer</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">status-writer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>While you only provided a single image, you can see that there are four listed. Each has a job as follows:</p><ul><li><code>reader</code> makes sure that the Resource Request is available to the pipeline</li><li><code>xaas-request-pipeline-stage-*</code> images are an ordered list from the provided containers in the Promise</li><li><code>work-writer</code> schedules the files in the <code>output</code> directory based on the labels provided</li><li><code>status-writer</code> updates the Resource Request status</li></ul><p>The most interesting container for you will be the one you created, the <code>xaas-request-pipeline-stage-0</code> container. To see the logs from this specific container you can run:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$PLATFORM</span><span class="token plain"> logs </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --selector kratix-promise-id</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">elastic-cloud-default </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --container xaas-request-pipeline-stage-0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The logs will look something like this:</p><div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token output">Downloading Operator...</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">Generate ECK requests...</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">wrote to-deploy/eck-stack/charts/eck-beats/templates/beats.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">wrote to-deploy/eck-stack/charts/eck-elasticsearch/templates/elasticsearch.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">wrote to-deploy/eck-stack/charts/eck-kibana/templates/kibana.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token output" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token output">Adding namespaces to all helm output files...</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">Removing enterprise annotation...</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">Copying files to /output...</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">Done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="verify-the-worker">Verify the worker<a href="#verify-the-worker" class="hash-link" aria-label="Direct link to Verify the worker" title="Direct link to Verify the worker">​</a></h3><p>While it is useful to verify the container has run by viewing the logs, the outcome you most want to verify is the scheduling and creation of an ECK instance.</p><p>To see this you will need to check the worker cluster where the ECK server was scheduled. First you may want to verify that the operator is running:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$WORKER</span><span class="token plain"> get pods -n elastic-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With the following output:</p><div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token output">NAME                 READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">elastic-operator-0   1/1     Running   0          1m</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With all the necessary CRDs installed:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$WORKER</span><span class="token plain"> get crds </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> elastic</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>which will result in something like:</p><div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token output">agents.agent.k8s.elastic.co                            2023-01-01T12:00:00Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">apmservers.apm.k8s.elastic.co                          2023-01-01T12:00:00Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">beats.beat.k8s.elastic.co                              2023-01-01T12:00:00Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">elasticmapsservers.maps.k8s.elastic.co                 2023-01-01T12:00:00Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">elasticsearchautoscalers.autoscaling.k8s.elastic.co    2023-01-01T12:00:00Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">elasticsearches.elasticsearch.k8s.elastic.co           2023-01-01T12:00:00Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">enterprisesearches.enterprisesearch.k8s.elastic.co     2023-01-01T12:00:00Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">kibanas.kibana.k8s.elastic.co                          2023-01-01T12:00:00Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">logstashes.logstash.k8s.elastic.co                     2023-01-01T12:00:00Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">stackconfigpolicies.stackconfigpolicy.k8s.elastic.co   2023-01-01T12:00:00Z</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Finally, you will want to see the provisioned instance by running:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$WORKER</span><span class="token plain"> get pods --watch</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The above command will give an output similar to (it may take a while for the
pods to be ready):</p><div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token output">NAME                                     READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">elasticsearch-es-default-0               1/1     Running   0          5m</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">example-eck-kibana-kb-6f4f95b787-4fqsr   1/1     Running   0          5m</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once the Ready column reports <code>1/1</code>, press <kbd>Ctrl</kbd>+<kbd>C</kbd> to
exit the watch mode.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="trying-to-request-a-second-instance">Trying to request a second instance<a href="#trying-to-request-a-second-instance" class="hash-link" aria-label="Direct link to Trying to request a second instance" title="Direct link to Trying to request a second instance">​</a></h3><p>The power of Kratix is the scalability of self-service, on-demand instances.
Therefore, it is expected that any Promise will have more than one Resource Request made to it.</p><p>To see how the current Promise responds to a second request, you will need to
make a second request with the a new name:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> resource-request.yaml </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">sed</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;s/name: example/name: second-request/&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  kubectl --context </span><span class="token variable" style="color:#36acaa">$PLATFORM</span><span class="token plain"> apply --filename -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once again, you can verify this request by listing elastic-clouds:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$PLATFORM</span><span class="token plain"> get elastic-clouds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Which should now show a second instance in the list:</p><div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token output">NAME             STATUS</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">example          Resource requested</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">second-request   Resource requested</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also see that a second pipeline has run by checking the pods:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$PLATFORM</span><span class="token plain"> get pods</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>However, when you go to check the status on the worker cluster, you will not see a second elastic cloud instance:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$WORKER</span><span class="token plain"> get pods</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is because the GitOps reconciliation has failed due to a duplication of documents across the two requests. You can see this failure by running:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$WORKER</span><span class="token plain"> get kustomizations -n flux-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The above command will give an output similar to:</p><div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token output">NAME                        AGE     READY   STATUS</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">kratix-workload-crds        9m15s   False   kustomize build failed: accumulating resources: accumulation err=&#x27;merging resources from &#x27;./00-default-elastic-cloud-default-default-second-request-crds.yaml&#x27;: may not add resource with an already registered id: CustomResourceDefinition.v1.apiextensions.k8s.io/agents.agent.k8s.elastic.co.[noNs]&#x27;: must build at directory: &#x27;/tmp/kustomization-1131766306/default/worker-cluster-1/crds/00-default-elastic-cloud-default-default-second-request-crds.yaml&#x27;: file is not directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token output">kratix-workload-resources   9m15s   False   dependency &#x27;flux-system/kratix-workload-crds&#x27; is not ready</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is because the current Promise pipeline consists of both the instance specific resources, but also the shared dependencies like the ECK Operator. The next step in this workshop will showcase how to separate shared dependencies from instance specific provisioning.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2><p>And with that, you have transformed Elastic Cloud into an on-demand service!</p><p>To recap the steps you took:</p><ol><li>✅<!-- --> <!-- --> <!-- -->Codified the steps to provision an ECK instance</li><li>✅<!-- --> <!-- --> <!-- -->Packaged this script into a Docker container</li><li>✅<!-- --> <!-- --> <!-- -->Validated the containers behaviour with a reusable test script</li><li>✅<!-- --> <!-- --> <!-- -->Added the container to the Kratix Promise pipeline</li><li>✅<!-- --> <!-- --> <!-- -->Installed the Promise and validated the created instance</li><li>✅<!-- --> <!-- --> <!-- -->Explored the limitations of all logic living in the pipeline</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cleanup">Clean up environment<a href="#cleanup" class="hash-link" aria-label="Direct link to Clean up environment" title="Direct link to Clean up environment">​</a></h2><p>Before moving on, please clean up your environment by deleting the current Promises and Resource Requests.
Kratix will, by default, clean up any Resource Requests when the parent Promise is deleted.</p><p>To delete all the Promises, run:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --context </span><span class="token variable" style="color:#36acaa">$PLATFORM</span><span class="token plain"> delete promises --all</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The above command will give an output similar to:</p><div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token output">promise.platform.kratix.io/elastic-cloud deleted</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="--congratulations">🎉 <!-- --> <!-- --> Congratulations!<a href="#--congratulations" class="hash-link" aria-label="Direct link to --congratulations" title="Direct link to --congratulations">​</a></h2><p>✅<!-- --> <!-- --> <!-- -->Your Promise can deliver on-demand services. <br>
👉🏾<!-- --> <!-- --> <!-- -->Next you will <a href="/docs/workshop/shared-dependencies">Extract shared dependencies</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/syntasso/kratix-docs/tree/main/docs/workshop/part-ii/02-service-on-demand.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/workshop/creating-an-api"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Creating your first service API</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/workshop/shared-dependencies"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Extracting shared dependencies</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-a-pipeline" class="table-of-contents__link toc-highlight">What is a Promise pipeline?</a><ul><li><a href="#design-principles" class="table-of-contents__link toc-highlight">Design principles</a></li></ul></li><li><a href="#write-docker-container" class="table-of-contents__link toc-highlight">Codify your delivery process in a Container</a><ul><li><a href="#write-the-pipeline-script" class="table-of-contents__link toc-highlight">Write the pipeline script</a></li><li><a href="#write-the-dockerfile" class="table-of-contents__link toc-highlight">Write the Dockerfile</a></li></ul></li><li><a href="#test-the-pipeline" class="table-of-contents__link toc-highlight">Test the pipeline</a><ul><li><a href="#create-simple-test-suite" class="table-of-contents__link toc-highlight">Create simple test suite</a></li><li><a href="#run-the-test" class="table-of-contents__link toc-highlight">Run the test</a></li></ul></li><li><a href="#add-container-to-pipeline" class="table-of-contents__link toc-highlight">Include this container in your Promise pipeline</a></li><li><a href="#install-promise" class="table-of-contents__link toc-highlight">Install the Promise</a><ul><li><a href="#prerequisite-setup" class="table-of-contents__link toc-highlight">Prerequisite setup</a></li><li><a href="#install-the-promise" class="table-of-contents__link toc-highlight">Install the Promise</a></li></ul></li><li><a href="#request-instance" class="table-of-contents__link toc-highlight">Request an on-demand instance of your Promise</a><ul><li><a href="#send-a-resource-request" class="table-of-contents__link toc-highlight">Send a Resource Request</a></li><li><a href="#verify-the-pipeline" class="table-of-contents__link toc-highlight">Verify the pipeline</a></li><li><a href="#verify-the-worker" class="table-of-contents__link toc-highlight">Verify the worker</a></li><li><a href="#trying-to-request-a-second-instance" class="table-of-contents__link toc-highlight">Trying to request a second instance</a></li></ul></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li><li><a href="#cleanup" class="table-of-contents__link toc-highlight">Clean up environment</a></li><li><a href="#--congratulations" class="table-of-contents__link toc-highlight">🎉   Congratulations!</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/main/intro">Getting Started</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/kratixio" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/syntasso/kratix" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://syntasso.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Syntasso<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Syntasso Limited. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.018423ec.js"></script>
<script src="/assets/js/main.6b807c86.js"></script>
</body>
</html>