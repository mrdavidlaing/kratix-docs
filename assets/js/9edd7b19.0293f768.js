"use strict";(self.webpackChunkkratix_docs=self.webpackChunkkratix_docs||[]).push([[5186],{5846:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>f,frontMatter:()=>t,metadata:()=>l,toc:()=>a});var i=o(5893),r=o(1151);const t={description:"Documentation for writing Promise Workflows using Kratix Pipelines, covering how Kratix internally executes the Pipeline containers",title:"Promise Workflows",sidebar_label:"Workflows"},s="Workflows",l={id:"main/reference/promises/workflows",title:"Promise Workflows",description:"Documentation for writing Promise Workflows using Kratix Pipelines, covering how Kratix internally executes the Pipeline containers",source:"@site/docs/main/05-reference/04-promises/04-workflows.md",sourceDirName:"main/05-reference/04-promises",slug:"/main/reference/promises/workflows",permalink:"/docs/main/reference/promises/workflows",draft:!1,unlisted:!1,editUrl:"https://github.com/syntasso/kratix-docs/tree/main/docs/main/05-reference/04-promises/04-workflows.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{description:"Documentation for writing Promise Workflows using Kratix Pipelines, covering how Kratix internally executes the Pipeline containers",title:"Promise Workflows",sidebar_label:"Workflows"},sidebar:"mainSidebar",previous:{title:"Updates",permalink:"/docs/main/reference/promises/updates"},next:{title:"Versioning",permalink:"/docs/main/reference/promises/releases"}},c={},a=[{value:"Running Workflows",id:"running-workflows",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"workflows",children:"Workflows"}),"\n",(0,i.jsxs)(n.p,{children:["Within a Kratix Promise, you can define two different workflow types:\n",(0,i.jsx)(n.code,{children:"configure"})," and ",(0,i.jsx)(n.code,{children:"delete"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"configure"})," workflow is executed when the Promise is created, updated, or\nreconciled. The ",(0,i.jsx)(n.code,{children:"delete"})," workflow is executed when the Promise is deleted."]}),"\n",(0,i.jsxs)(n.p,{children:["To specify the Promise workflows, you should use the ",(0,i.jsx)(n.code,{children:"workflows.promise"})," key in\nthe Promise definition:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"platform: platform.kratix.io/v1alpha1\nkind: Promise\nmetadata:\n  # ...\nspec:\n  # ...\n  workflows:\n    # lifecycle hook for Promise\n    promise:\n      # lifecycle hook for creates/updates/ongoing reconciliation of the Promise\n      configure:\n        -  # Pipeline definition\n      # lifecycle hook for deletion of the Promise\n      delete:\n        -  # Pipeline definition\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Check out the ",(0,i.jsx)(n.a,{href:"../workflows",children:"Workflows documentation"})," for more details."]}),"\n",(0,i.jsx)(n.h2,{id:"running-workflows",children:"Running Workflows"}),"\n",(0,i.jsx)(n.p,{children:"The Workflows are regularly executed. Kubernetes reconciles on a number of\ndifferent actions including, but not limited to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"On the creation of the Promise"}),"\n",(0,i.jsx)(n.li,{children:"Regular interval (default: 10 hours, not currently configurable)"}),"\n",(0,i.jsx)(n.li,{children:"Recreating or restarting the Kratix Controller"}),"\n",(0,i.jsx)(n.li,{children:"A change to the Promise definition"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"All commands should be idempotent as there is a guarantee that they will be run\nmultiple times a day, and may be run much more frequently depending on other\nenvironmental impacts like pod restarts."})]})}function f(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},1151:(e,n,o)=>{o.d(n,{Z:()=>l,a:()=>s});var i=o(7294);const r={},t=i.createContext(r);function s(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);