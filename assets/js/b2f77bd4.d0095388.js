"use strict";(self.webpackChunkkratix_docs=self.webpackChunkkratix_docs||[]).push([[4671],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=c(n),m=r,h=d["".concat(s,".").concat(m)]||d[m]||p[m]||l;return n?a.createElement(h,o(o({ref:t},u),{},{components:n})):a.createElement(h,o({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,o=new Array(l);o[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[d]="string"==typeof e?e:r,o[1]=i;for(var c=2;c<l;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5162:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(7294),r=n(6010);const l="tabItem_Ymn6";function o(e){let{children:t,hidden:n,className:o}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(l,o),hidden:n},t)}},4866:(e,t,n)=>{n.d(t,{Z:()=>N});var a=n(7462),r=n(7294),l=n(6010),o=n(2466),i=n(6550),s=n(1980),c=n(7392),u=n(12);function d(e){return function(e){return r.Children.map(e,(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}function p(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??d(n);return function(e){const t=(0,c.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function m(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function h(e){let{queryString:t=!1,groupId:n}=e;const a=(0,i.k6)(),l=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,s._X)(l),(0,r.useCallback)((e=>{if(!l)return;const t=new URLSearchParams(a.location.search);t.set(l,e),a.replace({...a.location,search:t.toString()})}),[l,a])]}function k(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,l=p(e),[o,i]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:l}))),[s,c]=h({queryString:n,groupId:a}),[d,k]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,l]=(0,u.Nk)(n);return[a,(0,r.useCallback)((e=>{n&&l.set(e)}),[n,l])]}({groupId:a}),f=(()=>{const e=s??d;return m({value:e,tabValues:l})?e:null})();(0,r.useLayoutEffect)((()=>{f&&i(f)}),[f]);return{selectedValue:o,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:l}))throw new Error(`Can't select invalid tab value=${e}`);i(e),c(e),k(e)}),[c,k,l]),tabValues:l}}var f=n(2389);const g="tabList__CuJ",b="tabItem_LNqP";function y(e){let{className:t,block:n,selectedValue:i,selectValue:s,tabValues:c}=e;const u=[],{blockElementScrollPositionUntilNextRender:d}=(0,o.o5)(),p=e=>{const t=e.currentTarget,n=u.indexOf(t),a=c[n].value;a!==i&&(d(t),s(a))},m=e=>{let t=null;switch(e.key){case"Enter":p(e);break;case"ArrowRight":{const n=u.indexOf(e.currentTarget)+1;t=u[n]??u[0];break}case"ArrowLeft":{const n=u.indexOf(e.currentTarget)-1;t=u[n]??u[u.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":n},t)},c.map((e=>{let{value:t,label:n,attributes:o}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:i===t?0:-1,"aria-selected":i===t,key:t,ref:e=>u.push(e),onKeyDown:m,onClick:p},o,{className:(0,l.Z)("tabs__item",b,o?.className,{"tabs__item--active":i===t})}),n??t)})))}function v(e){let{lazy:t,children:n,selectedValue:a}=e;const l=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=l.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},l.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function w(e){const t=k(e);return r.createElement("div",{className:(0,l.Z)("tabs-container",g)},r.createElement(y,(0,a.Z)({},e,t)),r.createElement(v,(0,a.Z)({},e,t)))}function N(e){const t=(0,f.Z)();return r.createElement(w,(0,a.Z)({key:String(t)},e))}},3001:(e,t,n)=>{n.d(t,{ZP:()=>s});var a=n(7462),r=(n(7294),n(3905)),l=n(4866),o=n(5162);const i={toc:[]};function s(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},i,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"To make this step simpler there is a ",(0,r.kt)("em",{parentName:"p"},"very basic")," tool which grabs all YAML documents from a single directory and injects them correctly into the ",(0,r.kt)("inlineCode",{parentName:"p"},"dependencies")," field in the ",(0,r.kt)("inlineCode",{parentName:"p"},"promise.yaml"),"."),(0,r.kt)("p",null,"To use this tool, you will need to download the correct binary for your computer from ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/syntasso/kratix/releases/tag/v0.0.4"},"GitHub releases"),":"),(0,r.kt)(l.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"darwin-amd64",label:"Intel Mac",default:!0,mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"mkdir -p bin\ncurl -sLo ./bin/worker-resource-builder.tar.gz https://github.com/syntasso/kratix/releases/download/v0.0.4/worker-resource-builder_0.0.4_darwin_amd64.tar.gz\ntar -xvf ./bin/worker-resource-builder.tar.gz -C ./bin\nmv ./bin/worker-resource-builder-v* ./bin/worker-resource-builder\nchmod +x ./bin/worker-resource-builder\n"))),(0,r.kt)(o.Z,{value:"darwin-arm64",label:"Apple Silicon Mac",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"mkdir -p bin\ncurl -sLo ./bin/worker-resource-builder.tar.gz https://github.com/syntasso/kratix/releases/download/v0.0.4/worker-resource-builder_0.0.4_darwin_arm64.tar.gz\ntar -xvf ./bin/worker-resource-builder.tar.gz -C ./bin\nmv ./bin/worker-resource-builder-v* ./bin/worker-resource-builder\nchmod +x ./bin/worker-resource-builder\n"))),(0,r.kt)(o.Z,{value:"linux-arm64",label:"Linux ARM64",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"mkdir -p bin\ncurl -sLo ./bin/worker-resource-builder.tar.gz https://github.com/syntasso/kratix/releases/download/v0.0.4/worker-resource-builder_0.0.4_linux_arm64.tar.gz\ntar -xvf ./bin/worker-resource-builder.tar.gz -C ./bin\nmv ./bin/worker-resource-builder-v* ./bin/worker-resource-builder\nchmod +x ./bin/worker-resource-builder\n"))),(0,r.kt)(o.Z,{value:"linux-amd64",label:"Linux AMD64",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"mkdir -p bin\ncurl -sLo ./bin/worker-resource-builder.tar.gz https://github.com/syntasso/kratix/releases/download/v0.0.4/worker-resource-builder_0.0.4_linux_amd64.tar.gz\ntar -xvf ./bin/worker-resource-builder.tar.gz -C ./bin\nmv ./bin/worker-resource-builder-v* ./bin/worker-resource-builder\nchmod +x ./bin/worker-resource-builder\n")))),(0,r.kt)("p",null,"Once installed, you can see how to use the binary by running the following help command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"./bin/worker-resource-builder --help\n")),(0,r.kt)("p",null,"The above command will give an output similar to:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell-session"},"Usage of ./bin/worker-resource-builder:\n  -resources-dir string\n        Absolute Path of k8s resources to build dependencies from\n  -promise string\n        Absolute path of Promise to insert dependencies into\n")))}s.isMDXComponent=!0},1567:(e,t,n)=>{n.d(t,{ZP:()=>o});var a=n(7462),r=(n(7294),n(3905));const l={toc:[]};function o(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Following the previous step of this tutorial, you should now\nhave a deployment of both Kratix and MinIO running on your platform cluster\nwith no installed Promises."),(0,r.kt)("p",null,"You should also have two environment variables, ",(0,r.kt)("inlineCode",{parentName:"p"},"PLATFORM")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"WORKER"),"."),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Verify the current state of your installation"),"Run:",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl --context $PLATFORM get deployments --namespace kratix-platform-system\n")),(0,r.kt)("p",null,"The above command will give an output similar to:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell-session"},"NAME                                 READY   UP-TO-DATE   AVAILABLE   AGE\nkratix-platform-controller-manager   1/1     1            1           1h\nminio                                1/1     1            1           1h\n")),(0,r.kt)("p",null,"You should also have a State Store created and configured to point to the\n",(0,r.kt)("inlineCode",{parentName:"p"},"kratix")," bucket on MinIO. Verify the ",(0,r.kt)("inlineCode",{parentName:"p"},"bucketstatestores"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl --context $PLATFORM get bucketstatestores.platform.kratix.io\n")),(0,r.kt)("p",null,"The above command will give an output similar to:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell-session"},"NAME          AGE\nminio-store   1h\n")),(0,r.kt)("p",null,"Verify there are no existing Promises:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl --context $PLATFORM get promises\n")),(0,r.kt)("p",null,"Verify your cluster environment variables are set:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"env | grep 'PLATFORM\\|WORKER'\n")),(0,r.kt)("p",null,"which should result in:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell-session"},"WORKER=kind-worker\nPLATFORM=kind-platform\n"))),(0,r.kt)("p",null,"If you are are not continuing from the previous section, or your outputs do not align with the validation, please refer back to\n",(0,r.kt)("a",{parentName:"p",href:"installing-kratix"},"Installing Kratix"),"."))}o.isMDXComponent=!0},9429:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>D,contentTitle:()=>A,default:()=>I,frontMatter:()=>O,metadata:()=>M,toc:()=>S});var a,r,l,o,i,s,c,u,d,p,m,h,k,f,g,b,y,v,w=n(7462),N=n(7294),E=n(3905),x=n(4996),P=(n(4866),n(5162),n(1567)),T=n(3001);function R(){return R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},R.apply(this,arguments)}const C=e=>{let{title:t,titleId:n,...w}=e;return N.createElement("svg",R({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 519.664 317.243",width:519.664,height:317.243,"aria-labelledby":n},w),t?N.createElement("title",{id:n},t):null,a||(a=N.createElement("defs",null,N.createElement("style",null,'@font-face{font-family:"Virgil";src:url(https://excalidraw.com/Virgil.woff2)}@font-face{font-family:"Cascadia";src:url(https://excalidraw.com/Cascadia.woff2)}'))),r||(r=N.createElement("g",{strokeLinecap:"round"},N.createElement("path",{d:"M30.895 192.821h282.58v70.16H30.895",strokeWidth:0,fill:"#e64980"}),N.createElement("path",{d:"M30.895 192.821h282.58m-282.58 0h282.58m0 0v70.16m0-70.16v70.16m0 0H30.895m282.58 0H30.895m0 0v-70.16m0 70.16v-70.16",stroke:"#a61e4d",fill:"none"}))),N.createElement("text",{fontFamily:"Virgil, Segoe UI Emoji",fontSize:20,style:{whiteSpace:"pre"},dominantBaseline:"text-before-edge",transform:"translate(112.024 215.874)"},"Dependencies"),N.createElement("text",{fontFamily:"Virgil, Segoe UI Emoji",fontSize:28,fill:"#5f3dc4",style:{whiteSpace:"pre"},dominantBaseline:"text-before-edge",transform:"translate(81.205 31.046)"},"Promise"),l||(l=N.createElement("path",{d:"M42 10h263.38M42 10h263.38m0 0c21.34 0 32 10.67 32 32m-32-32c21.34 0 32 10.67 32 32m0 0v212.05m0-212.05v212.05m0 0c0 21.33-10.66 32-32 32m32-32c0 21.33-10.66 32-32 32m0 0H42m263.38 0H42m0 0c-21.33 0-32-10.67-32-32m32 32c-21.33 0-32-10.67-32-32m0 0V42m0 212.05V42m0 0c0-21.33 10.67-32 32-32M10 42c0-21.33 10.67-32 32-32",stroke:"#343a40",strokeWidth:2,fill:"none",strokeLinecap:"round"})),o||(o=N.createElement("g",{strokeOpacity:.3,fillOpacity:.3,strokeLinecap:"round"},N.createElement("path",{d:"M181.457 104.324h110.73l6.84.98 4.89 2.93 1.71 2.2 1.96 5.87.24 34.96-.98 6.84-1.22 2.69-3.91 3.91-2.69 1.22-6.84.98h-110.73l-6.85-.98-2.69-1.22-3.91-3.91-1.96-5.87v-38.62l1.96-5.87 3.91-3.91 2.69-1.22 6.85-.98",strokeWidth:0,fill:"#15aabf"}),N.createElement("path",{d:"M181.457 104.324h110.73m-110.73 0h110.73m0 0c10.43 0 15.64 5.22 15.64 15.65m-15.64-15.65c10.43 0 15.64 5.22 15.64 15.65m0 0v31.29m0-31.29v31.29m0 0c0 10.43-5.21 15.64-15.64 15.64m15.64-15.64c0 10.43-5.21 15.64-15.64 15.64m0 0h-110.73m110.73 0h-110.73m0 0c-10.43 0-15.65-5.21-15.65-15.64m15.65 15.64c-10.43 0-15.65-5.21-15.65-15.64m0 0v-31.29m0 31.29v-31.29m0 0c0-10.43 5.22-15.65 15.65-15.65m-15.65 15.65c0-10.43 5.22-15.65 15.65-15.65",stroke:"#343a40",fill:"none"}))),N.createElement("g",{strokeOpacity:.3,fillOpacity:.3},N.createElement("text",{x:51.69,fontFamily:"Virgil, Segoe UI Emoji",fontSize:20,textAnchor:"middle",style:{whiteSpace:"pre"},dominantBaseline:"text-before-edge",transform:"translate(182.151 110.839)"},"Imperative"),N.createElement("text",{x:51.69,y:25,fontFamily:"Virgil, Segoe UI Emoji",fontSize:20,textAnchor:"middle",style:{whiteSpace:"pre"},dominantBaseline:"text-before-edge",transform:"translate(182.151 110.839)"},"Pipeline")),i||(i=N.createElement("g",{strokeOpacity:.3,fillOpacity:.3,strokeLinecap:"round"},N.createElement("path",{d:"m374.744 275.243.427-76.18 1.494-6.502 2.494-5.502 3.496-4.504 4.497-3.504 5.497-2.505 6.499-1.506 7.5-.508 78.39.425 6.501 1.494 5.503 2.495 4.503 3.495 3.504 4.497 2.506 5.498 1.506 6.498.507 7.5-.427 76.18-1.494 6.502-2.495 5.502-3.495 4.503-4.497 3.505-5.498 2.505-6.498 1.506-7.5.507-78.39-.425-6.501-1.493-5.503-2.495-4.503-3.496-3.505-4.496-2.505-5.498-1.506-6.499-.507-7.5",strokeWidth:0,fill:"#ced4da"}),N.createElement("path",{d:"m374.744 275.243-.066-68.68m.066 68.68-.066-68.68m0 0c-.02-21.34 10.64-32.01 31.97-32.03m-31.97 32.03c-.02-21.34 10.64-32.01 31.97-32.03m0 0 70.89-.069m-70.89.068 70.89-.068m0 0c21.33-.02 32.01 10.63 32.03 31.97m-32.03-31.97c21.33-.02 32.01 10.63 32.03 31.97m0 0 .066 68.68m-.066-68.68.066 68.68m0 0c.02 21.33-10.64 32.01-31.97 32.03m31.97-32.03c.02 21.33-10.64 32.01-31.97 32.03m0 0-70.89.068m70.89-.068-70.89.068m0 0c-21.33.02-32.01-10.64-32.03-31.97m32.03 31.97c-21.33.02-32.01-10.64-32.03-31.97",stroke:"transparent",fill:"none"}))),s||(s=N.createElement("g",{strokeOpacity:.3,fillOpacity:.3,strokeLinecap:"round"},N.createElement("path",{d:"M441.797 157.39c2.94-.004 5.91.064 8.83.21 2.91.138 5.83.355 8.671.642 2.84.288 5.66.655 8.381 1.082 2.71.428 5.381.925 7.932 1.483 2.54.557 5.02 1.185 7.351 1.873a89.275 89.275 0 0 1 6.652 2.213 64.955 64.955 0 0 1 5.833 2.535 46.7 46.7 0 0 1 4.913 2.795c1.48.979 2.792 1.987 3.922 3.026 1.121 1.04 2.083 2.108 2.844 3.198.76 1.079 1.342 2.188 1.723 3.308.39 1.11.582 2.24.583 3.36.001 1.13-.188 2.26-.577 3.37-.379 1.11-.958 2.23-1.717 3.312-.759 1.08-1.718 2.161-2.837 3.192a30.382 30.382 0 0 1-3.917 3.034 46.708 46.708 0 0 1-4.907 2.815 64.976 64.976 0 0 1-5.828 2.535 84.85 84.85 0 0 1-6.647 2.237c-2.33.682-4.81 1.314-7.349 1.877a129.79 129.79 0 0 1-7.928 1.507c-2.72.433-5.54.796-8.38 1.088-2.839.293-5.759.516-8.669.669-2.92.153-5.89.225-8.83.228a172.202 172.202 0 0 1-17.5-.863c-2.84-.287-5.65-.645-8.371-1.072-2.72-.427-5.391-.925-7.932-1.492a114.403 114.403 0 0 1-7.361-1.863 84.85 84.85 0 0 1-6.653-2.224 64.976 64.976 0 0 1-5.832-2.524 46.708 46.708 0 0 1-4.913-2.806c-1.47-.968-2.792-1.987-3.913-3.026a20.243 20.243 0 0 1-2.853-3.187c-.76-1.08-1.342-2.199-1.723-3.309a10.124 10.124 0 0 1-.583-3.37 10.11 10.11 0 0 1 .577-3.36c.379-1.12.958-2.23 1.717-3.311.769-1.091 1.718-2.162 2.847-3.203 1.119-1.041 2.438-2.052 3.907-3.034a46.7 46.7 0 0 1 4.907-2.804 64.955 64.955 0 0 1 5.828-2.546 89.275 89.275 0 0 1 6.647-2.226c2.34-.693 4.81-1.325 7.359-1.887 2.54-.563 5.209-1.065 7.928-1.498 2.72-.433 5.53-.805 8.37-1.098 2.839-.293 5.759-.516 8.678-.658 2.91-.153 7.35-.197 8.82-.229 1.47-.041-1.47-.038 0 0",strokeWidth:0,fill:"#868e96"}),N.createElement("path",{d:"M441.797 157.39c2.94-.004 5.91.064 8.83.21 2.91.138 5.83.355 8.671.642 2.84.288 5.66.655 8.381 1.082 2.71.428 5.381.925 7.932 1.483 2.54.557 5.02 1.185 7.351 1.873a89.275 89.275 0 0 1 6.652 2.213 64.955 64.955 0 0 1 5.833 2.535 46.7 46.7 0 0 1 4.913 2.795c1.48.979 2.792 1.987 3.922 3.026 1.121 1.04 2.083 2.108 2.844 3.198.76 1.079 1.342 2.188 1.723 3.308.39 1.11.582 2.24.583 3.36.001 1.13-.188 2.26-.577 3.37-.379 1.11-.958 2.23-1.717 3.312-.759 1.08-1.718 2.161-2.837 3.192a30.382 30.382 0 0 1-3.917 3.034 46.708 46.708 0 0 1-4.907 2.815 64.976 64.976 0 0 1-5.828 2.535 84.85 84.85 0 0 1-6.647 2.237c-2.33.682-4.81 1.314-7.349 1.877a129.79 129.79 0 0 1-7.928 1.507c-2.72.433-5.54.796-8.38 1.088-2.839.293-5.759.516-8.669.669-2.92.153-5.89.225-8.83.228a172.202 172.202 0 0 1-17.5-.863c-2.84-.287-5.65-.645-8.371-1.072-2.72-.427-5.391-.925-7.932-1.492a114.403 114.403 0 0 1-7.361-1.863 84.85 84.85 0 0 1-6.653-2.224 64.976 64.976 0 0 1-5.832-2.524 46.708 46.708 0 0 1-4.913-2.806c-1.47-.968-2.792-1.987-3.913-3.026a20.243 20.243 0 0 1-2.853-3.187c-.76-1.08-1.342-2.199-1.723-3.309a10.124 10.124 0 0 1-.583-3.37 10.11 10.11 0 0 1 .577-3.36c.379-1.12.958-2.23 1.717-3.311.769-1.091 1.718-2.162 2.847-3.203 1.119-1.041 2.438-2.052 3.907-3.034a46.7 46.7 0 0 1 4.907-2.804 64.955 64.955 0 0 1 5.828-2.546 89.275 89.275 0 0 1 6.647-2.226c2.34-.693 4.81-1.325 7.359-1.887 2.54-.563 5.209-1.065 7.928-1.498 2.72-.433 5.53-.805 8.37-1.098 2.839-.293 5.759-.516 8.678-.658 2.91-.153 7.35-.197 8.82-.229 1.47-.041-1.47-.038 0 0",stroke:"#343a40",fill:"none"}))),N.createElement("g",{strokeOpacity:.3,fillOpacity:.3},N.createElement("text",{x:47.536,fontFamily:"Virgil, Segoe UI Emoji",fontSize:16.654,fill:"#343a40",textAnchor:"middle",style:{whiteSpace:"pre"},dominantBaseline:"text-before-edge",transform:"translate(393.297 223.006)"},"Declarative"),N.createElement("text",{x:47.536,y:20.817,fontFamily:"Virgil, Segoe UI Emoji",fontSize:16.654,fill:"#343a40",textAnchor:"middle",style:{whiteSpace:"pre"},dominantBaseline:"text-before-edge",transform:"translate(393.297 223.006)"},"State"),N.createElement("text",{x:47.536,y:41.635,fontFamily:"Virgil, Segoe UI Emoji",fontSize:16.654,fill:"#343a40",textAnchor:"middle",style:{whiteSpace:"pre"},dominantBaseline:"text-before-edge",transform:"translate(393.297 223.006)"},"Store")),c||(c=N.createElement("g",{strokeLinecap:"round"},N.createElement("path",{d:"m88.39 137.786 76.42-.3m-76.42.3 76.42-.3M136.66 147.856c8.39-3.09 16.78-6.18 28.15-10.37m-28.15 10.37c6.22-2.29 12.45-4.58 28.15-10.37M136.58 127.336c8.41 3.03 16.83 6.06 28.23 10.15m-28.23-10.15c6.24 2.25 12.48 4.49 28.23 10.15",stroke:"#2b8a3e",strokeWidth:4,fill:"none"}))),u||(u=N.createElement("g",{strokeLinecap:"round"},N.createElement("path",{d:"M309.7 138.56c9.7.32 44.83-2.15 58.21 1.89 13.39 4.05 18.42 18.65 22.1 22.38m-80.31-24.27c9.7.32 44.83-2.15 58.21 1.89 13.39 4.05 18.42 18.65 22.1 22.38",stroke:"#2b8a3e",strokeWidth:4,fill:"none"}),N.createElement("path",{d:"M377.28 153.6c4.05 2.94 8.1 5.87 12.73 9.23m-12.73-9.23c3.05 2.22 6.11 4.43 12.73 9.23",stroke:"#2b8a3e",strokeWidth:4,fill:"none"}),N.createElement("path",{d:"M386.18 147.58c1.22 4.85 2.44 9.7 3.83 15.25m-3.83-15.25c.92 3.66 1.84 7.32 3.83 15.25",stroke:"#2b8a3e",strokeWidth:4,fill:"none"}))),d||(d=N.createElement("g",{strokeLinecap:"round"},N.createElement("path",{d:"m37.686 24.953 3.77-.07 1.428.443.497 1.401.66 35.344-.444 1.418-1.41.497-5.189-.373-.496-1.401-.66-35.344.443-1.419 1.401-.496",strokeWidth:0,fill:"#7950f2"}),N.createElement("path",{d:"m37.686 24.953 3.77-.07m-3.77.07 3.77-.07m0 0c1.26-.024 1.901.594 1.925 1.844m-1.925-1.844c1.26-.024 1.901.594 1.925 1.844m0 0 .66 35.344m-.66-35.344.66 35.344m0 0c.023 1.25-.595 1.891-1.855 1.915m1.855-1.915c.023 1.25-.595 1.891-1.855 1.915m0 0-3.769.07m3.77-.07-3.77.07m0 0c-1.25.024-1.891-.594-1.915-1.844m1.915 1.844c-1.25.024-1.891-.594-1.915-1.844m0 0-.66-35.344m.66 35.344-.66-35.344m0 0c-.023-1.25.595-1.891 1.844-1.915m-1.844 1.915c-.023-1.25.595-1.891 1.844-1.915",stroke:"transparent",fill:"none"}))),p||(p=N.createElement("g",{strokeLinecap:"round"},N.createElement("path",{d:"m68.609 24.61 2.87 2.445.776 1.278-.556 1.379-29.701 34.877-1.272.769-1.386-.563-3.639-3.717.556-1.378 29.701-34.877 1.272-.769 1.379.557",strokeWidth:0,fill:"#7950f2"}),N.createElement("path",{d:"m68.609 24.61 2.87 2.445m-2.87-2.444 2.87 2.444m0 0c.96.817 1.03 1.705.22 2.657m-.22-2.657c.96.817 1.03 1.705.22 2.657m0 0L41.998 64.589m29.7-34.877-29.7 34.877m0 0c-.81.951-1.699 1.023-2.658.206m2.658-.206c-.81.951-1.699 1.023-2.658.206m0 0-2.87-2.445m2.87 2.445-2.87-2.445m0 0c-.952-.81-1.023-1.698-.213-2.65m.213 2.65c-.952-.81-1.023-1.698-.213-2.65m0 0 29.701-34.877M36.258 59.7l29.7-34.877m0 0c.81-.952 1.699-1.023 2.65-.212m-2.65.212c.81-.952 1.699-1.023 2.65-.212",stroke:"transparent",fill:"none"}))),m||(m=N.createElement("g",{strokeLinecap:"round"},N.createElement("path",{d:"m73.289 62.102-2.855 2.462-1.382.572-1.277-.76L51.753 45.8l-.565-1.374.762-1.291 4.236-3.02 1.277.76 16.021 18.576.566 1.374-.761 1.277",strokeWidth:0,fill:"#7950f2"}),N.createElement("path",{d:"m73.289 62.102-2.855 2.462m2.855-2.462-2.855 2.462m0 0c-.954.823-1.843.758-2.66-.189m2.66.19c-.954.822-1.843.757-2.66-.19m0 0L51.755 45.8m16.02 18.575L51.755 45.8m0 0c-.824-.954-.758-1.842.196-2.665m-.197 2.665c-.823-.954-.757-1.842.197-2.665m0 0 2.855-2.463m-2.855 2.463 2.855-2.463m0 0c.946-.816 1.835-.75 2.658.204m-2.658-.204c.946-.816 1.835-.75 2.658.204m0 0L73.484 59.45M57.463 40.876 73.484 59.45m0 0c.817.946.751 1.835-.195 2.651m.195-2.651c.817.946.751 1.835-.195 2.651",stroke:"transparent",fill:"none"}))),h||(h=N.createElement("g",{strokeLinecap:"round"},N.createElement("path",{d:"M43.712 27.393c.008.26-.003.53-.034.791a5.093 5.093 0 0 1-.165.776 4.223 4.223 0 0 1-.286.73 4.594 4.594 0 0 1-.399.673 4.6 4.6 0 0 1-.501.577c-.185.176-.38.333-.585.48a4.517 4.517 0 0 1-.649.35 4.444 4.444 0 0 1-.703.234 3.611 3.611 0 0 1-.727.093c-.25.009-.49-.004-.732-.046a4.444 4.444 0 0 1-1.397-.494 5.303 5.303 0 0 1-.614-.44 5.557 5.557 0 0 1-.538-.543 7.393 7.393 0 0 1-.442-.646 5.203 5.203 0 0 1-.333-.71 6.657 6.657 0 0 1-.215-.763 5.253 5.253 0 0 1-.051-1.58c.041-.26.093-.523.164-.775.082-.253.174-.506.286-.74.123-.224.256-.458.399-.663.153-.205.327-.401.501-.577.185-.176.38-.342.585-.48a4.444 4.444 0 0 1 1.362-.585c.238-.057.477-.085.727-.093.24-.008.49.004.732.046.241.043.484.105.716.187.223.083.457.185.67.309.215.123.42.276.616.44a4.6 4.6 0 0 1 .537.542 4.5 4.5 0 0 1 .775 1.356c.088.247.167.505.215.763.049.259.072.658.086.788.014.13.006-.13 0 0",strokeWidth:0,fill:"#7950f2"}),N.createElement("path",{d:"M43.712 27.393c.008.26-.003.53-.034.791a5.093 5.093 0 0 1-.165.776 4.223 4.223 0 0 1-.286.73 4.594 4.594 0 0 1-.399.673 4.6 4.6 0 0 1-.501.577c-.185.176-.38.333-.585.48a4.517 4.517 0 0 1-.649.35 4.444 4.444 0 0 1-.703.234 3.611 3.611 0 0 1-.727.093c-.25.009-.49-.004-.732-.046a4.444 4.444 0 0 1-1.397-.494 5.303 5.303 0 0 1-.614-.44 5.557 5.557 0 0 1-.538-.543 7.393 7.393 0 0 1-.442-.646 5.203 5.203 0 0 1-.333-.71 6.657 6.657 0 0 1-.215-.763 5.253 5.253 0 0 1-.051-1.58c.041-.26.093-.523.164-.775.082-.253.174-.506.286-.74.123-.224.256-.458.399-.663.153-.205.327-.401.501-.577.185-.176.38-.342.585-.48a4.444 4.444 0 0 1 1.362-.585c.238-.057.477-.085.727-.093.24-.008.49.004.732.046.241.043.484.105.716.187.223.083.457.185.67.309.215.123.42.276.616.44a4.6 4.6 0 0 1 .537.542 4.5 4.5 0 0 1 .775 1.356c.088.247.167.505.215.763.049.259.072.658.086.788.014.13.006-.13 0 0",stroke:"#5f3dc4",fill:"none"}))),k||(k=N.createElement("g",{strokeLinecap:"round"},N.createElement("path",{d:"M44.672 59.64c.009.26-.002.531-.034.792a5.093 5.093 0 0 1-.164.776 4.223 4.223 0 0 1-.287.73 4.594 4.594 0 0 1-.398.673 4.6 4.6 0 0 1-.502.577c-.184.176-.379.333-.584.48a4.517 4.517 0 0 1-.65.35 4.444 4.444 0 0 1-.702.234 3.611 3.611 0 0 1-.727.093c-.25.009-.49-.004-.732-.046a4.444 4.444 0 0 1-1.397-.494 5.303 5.303 0 0 1-.615-.44 5.557 5.557 0 0 1-.538-.543 7.393 7.393 0 0 1-.441-.646 5.203 5.203 0 0 1-.333-.71 6.657 6.657 0 0 1-.215-.763 5.253 5.253 0 0 1-.052-1.58c.042-.26.093-.523.165-.775.082-.253.174-.506.286-.74.123-.224.255-.458.399-.663.153-.205.327-.401.501-.577.184-.176.38-.342.585-.48a4.444 4.444 0 0 1 1.362-.585c.238-.057.477-.084.727-.093.24-.007.49.004.732.047.241.042.483.104.716.186.223.083.456.185.67.309a4.6 4.6 0 0 1 1.153.983 4.5 4.5 0 0 1 .775 1.355c.088.247.166.505.215.763.048.259.071.658.085.788.015.13.006-.13 0 0",strokeWidth:0,fill:"#7950f2"}),N.createElement("path",{d:"M44.672 59.64c.009.26-.002.531-.034.792a5.093 5.093 0 0 1-.164.776 4.223 4.223 0 0 1-.287.73 4.594 4.594 0 0 1-.398.673 4.6 4.6 0 0 1-.502.577c-.184.176-.379.333-.584.48a4.517 4.517 0 0 1-.65.35 4.444 4.444 0 0 1-.702.234 3.611 3.611 0 0 1-.727.093c-.25.009-.49-.004-.732-.046a4.444 4.444 0 0 1-1.397-.494 5.303 5.303 0 0 1-.615-.44 5.557 5.557 0 0 1-.538-.543 7.393 7.393 0 0 1-.441-.646 5.203 5.203 0 0 1-.333-.71 6.657 6.657 0 0 1-.215-.763 5.253 5.253 0 0 1-.052-1.58c.042-.26.093-.523.165-.775.082-.253.174-.506.286-.74.123-.224.255-.458.399-.663.153-.205.327-.401.501-.577.184-.176.38-.342.585-.48a4.444 4.444 0 0 1 1.362-.585c.238-.057.477-.084.727-.093.24-.007.49.004.732.047.241.042.483.104.716.186.223.083.456.185.67.309a4.6 4.6 0 0 1 1.153.983 4.5 4.5 0 0 1 .775 1.355c.088.247.166.505.215.763.048.259.071.658.085.788.015.13.006-.13 0 0",stroke:"#5f3dc4",fill:"none"}))),f||(f=N.createElement("g",{strokeLinecap:"round"},N.createElement("path",{d:"M59.14 45.544c.008.26-.003.53-.034.792a5.093 5.093 0 0 1-.165.776 3.555 3.555 0 0 1-.286.73 5.59 5.59 0 0 1-.389.672 4.6 4.6 0 0 1-.501.577c-.175.176-.37.332-.575.479a4.067 4.067 0 0 1-.649.351 4.653 4.653 0 0 1-.693.233 3.611 3.611 0 0 1-.727.094c-.24.008-.48-.005-.722-.047a3.97 3.97 0 0 1-1.377-.495 5.303 5.303 0 0 1-.614-.44 4.52 4.52 0 0 1-.97-1.19 4.223 4.223 0 0 1-.333-.709 6.657 6.657 0 0 1-.215-.763 5.253 5.253 0 0 1-.051-1.58c.041-.26.093-.523.164-.775a4.5 4.5 0 0 1 .685-1.403c.143-.205.317-.4.491-.577.185-.176.38-.342.585-.479a3.97 3.97 0 0 1 1.342-.584c.238-.058.477-.086.717-.093.24-.008.49.004.732.046.231.042.474.104.706.187a3.741 3.741 0 0 1 1.275.749 4.6 4.6 0 0 1 .539.542c.156.195.303.42.43.637.138.225.246.472.334.72.088.246.167.504.215.763.049.258.072.658.086.787.014.13.006-.13 0 0",strokeWidth:0,fill:"#7950f2"}),N.createElement("path",{d:"M59.14 45.544c.008.26-.003.53-.034.792a5.093 5.093 0 0 1-.165.776 3.555 3.555 0 0 1-.286.73 5.59 5.59 0 0 1-.389.672 4.6 4.6 0 0 1-.501.577c-.175.176-.37.332-.575.479a4.067 4.067 0 0 1-.649.351 4.653 4.653 0 0 1-.693.233 3.611 3.611 0 0 1-.727.094c-.24.008-.48-.005-.722-.047a3.97 3.97 0 0 1-1.377-.495 5.303 5.303 0 0 1-.614-.44 4.52 4.52 0 0 1-.97-1.19 4.223 4.223 0 0 1-.333-.709 6.657 6.657 0 0 1-.215-.763 5.253 5.253 0 0 1-.051-1.58c.041-.26.093-.523.164-.775a4.5 4.5 0 0 1 .685-1.403c.143-.205.317-.4.491-.577.185-.176.38-.342.585-.479a3.97 3.97 0 0 1 1.342-.584c.238-.058.477-.086.717-.093.24-.008.49.004.732.046.231.042.474.104.706.187a3.741 3.741 0 0 1 1.275.749 4.6 4.6 0 0 1 .539.542c.156.195.303.42.43.637.138.225.246.472.334.72.088.246.167.504.215.763.049.258.072.658.086.787.014.13.006-.13 0 0",stroke:"#5f3dc4",fill:"none"}))),g||(g=N.createElement("g",{strokeLinecap:"round"},N.createElement("path",{d:"M72.356 28.194c.008.26-.003.53-.034.792a5.093 5.093 0 0 1-.165.775 4.223 4.223 0 0 1-.287.73 4.594 4.594 0 0 1-.398.674 4.6 4.6 0 0 1-.501.576c-.185.176-.38.333-.585.48a4.517 4.517 0 0 1-.649.35 4.444 4.444 0 0 1-.703.234 3.611 3.611 0 0 1-.727.094c-.25.008-.49-.004-.732-.046a4.444 4.444 0 0 1-1.397-.495 5.303 5.303 0 0 1-.614-.44 5.557 5.557 0 0 1-.538-.543 7.393 7.393 0 0 1-.442-.646 5.203 5.203 0 0 1-.333-.71 6.657 6.657 0 0 1-.215-.763 5.253 5.253 0 0 1-.052-1.58c.042-.26.093-.522.165-.775.082-.253.174-.506.286-.74.123-.224.255-.458.399-.663.153-.205.327-.4.501-.577.185-.176.38-.342.585-.479a4.444 4.444 0 0 1 1.362-.585c.238-.057.477-.085.727-.093.24-.008.49.004.732.046.241.042.484.104.716.186.223.083.457.186.67.309a4.6 4.6 0 0 1 1.153.983 4.5 4.5 0 0 1 .775 1.355c.088.247.167.505.215.764.049.258.072.658.086.787.014.13.006-.13 0 0",strokeWidth:0,fill:"#7950f2"}),N.createElement("path",{d:"M72.356 28.194c.008.26-.003.53-.034.792a5.093 5.093 0 0 1-.165.775 4.223 4.223 0 0 1-.287.73 4.594 4.594 0 0 1-.398.674 4.6 4.6 0 0 1-.501.576c-.185.176-.38.333-.585.48a4.517 4.517 0 0 1-.649.35 4.444 4.444 0 0 1-.703.234 3.611 3.611 0 0 1-.727.094c-.25.008-.49-.004-.732-.046a4.444 4.444 0 0 1-1.397-.495 5.303 5.303 0 0 1-.614-.44 5.557 5.557 0 0 1-.538-.543 7.393 7.393 0 0 1-.442-.646 5.203 5.203 0 0 1-.333-.71 6.657 6.657 0 0 1-.215-.763 5.253 5.253 0 0 1-.052-1.58c.042-.26.093-.522.165-.775.082-.253.174-.506.286-.74.123-.224.255-.458.399-.663.153-.205.327-.4.501-.577.185-.176.38-.342.585-.479a4.444 4.444 0 0 1 1.362-.585c.238-.057.477-.085.727-.093.24-.008.49.004.732.046.241.042.484.104.716.186.223.083.457.186.67.309a4.6 4.6 0 0 1 1.153.983 4.5 4.5 0 0 1 .775 1.355c.088.247.167.505.215.764.049.258.072.658.086.787.014.13.006-.13 0 0",stroke:"#5f3dc4",fill:"none"}))),b||(b=N.createElement("g",{strokeLinecap:"round"},N.createElement("path",{d:"M74.407 61.208c.008.26-.003.53-.034.791a5.093 5.093 0 0 1-.165.776 4.223 4.223 0 0 1-.287.73 4.594 4.594 0 0 1-.398.673 4.6 4.6 0 0 1-.501.577c-.185.176-.38.332-.585.479a4.517 4.517 0 0 1-.649.351 4.444 4.444 0 0 1-.703.233 3.611 3.611 0 0 1-.727.094c-.25.008-.49-.004-.732-.046a4.444 4.444 0 0 1-1.397-.495 5.303 5.303 0 0 1-.614-.44 5.557 5.557 0 0 1-.538-.543 7.393 7.393 0 0 1-.442-.646 5.203 5.203 0 0 1-.333-.71 6.657 6.657 0 0 1-.215-.763 5.253 5.253 0 0 1-.052-1.579c.042-.261.093-.523.165-.776.082-.252.174-.505.286-.74.123-.223.255-.458.399-.663.153-.205.327-.4.501-.576.185-.176.38-.343.585-.48a4.444 4.444 0 0 1 1.362-.585c.238-.057.477-.085.727-.093.24-.008.49.004.732.046.241.042.484.104.716.187.223.083.457.185.67.308a4.6 4.6 0 0 1 1.153.983 4.5 4.5 0 0 1 .775 1.356c.088.247.167.504.215.763.049.258.072.658.086.788.014.13.006-.13 0 0",strokeWidth:0,fill:"#7950f2"}),N.createElement("path",{d:"M74.407 61.208c.008.26-.003.53-.034.791a5.093 5.093 0 0 1-.165.776 4.223 4.223 0 0 1-.287.73 4.594 4.594 0 0 1-.398.673 4.6 4.6 0 0 1-.501.577c-.185.176-.38.332-.585.479a4.517 4.517 0 0 1-.649.351 4.444 4.444 0 0 1-.703.233 3.611 3.611 0 0 1-.727.094c-.25.008-.49-.004-.732-.046a4.444 4.444 0 0 1-1.397-.495 5.303 5.303 0 0 1-.614-.44 5.557 5.557 0 0 1-.538-.543 7.393 7.393 0 0 1-.442-.646 5.203 5.203 0 0 1-.333-.71 6.657 6.657 0 0 1-.215-.763 5.253 5.253 0 0 1-.052-1.579c.042-.261.093-.523.165-.776.082-.252.174-.505.286-.74.123-.223.255-.458.399-.663.153-.205.327-.4.501-.576.185-.176.38-.343.585-.48a4.444 4.444 0 0 1 1.362-.585c.238-.057.477-.085.727-.093.24-.008.49.004.732.046.241.042.484.104.716.187.223.083.457.185.67.308a4.6 4.6 0 0 1 1.153.983 4.5 4.5 0 0 1 .775 1.356c.088.247.167.504.215.763.049.258.072.658.086.788.014.13.006-.13 0 0",stroke:"#5f3dc4",fill:"none"}))),y||(y=N.createElement("path",{d:"M43.325 27.85c.007.22-.005.45-.038.672-.023.221-.076.443-.149.655a3.329 3.329 0 0 1-.25.619 3.525 3.525 0 0 1-.352.562c-.134.184-.288.35-.444.494-.165.146-.34.292-.527.408a3.1 3.1 0 0 1-.57.299 3.573 3.573 0 0 1-1.923.243 3.727 3.727 0 0 1-.636-.16 3.524 3.524 0 0 1-.599-.26 4.802 4.802 0 0 1-.542-.373 3.505 3.505 0 0 1-.475-.465 4.224 4.224 0 0 1-.687-1.138 3.63 3.63 0 0 1-.182-.644 3.793 3.793 0 0 1-.044-1.34c.023-.22.076-.442.139-.665a4.07 4.07 0 0 1 .612-1.18c.134-.175.289-.34.444-.495.165-.145.34-.281.517-.397.186-.116.383-.223.58-.31.208-.076.416-.143.624-.19a3.493 3.493 0 0 1 1.3-.042c.21.033.423.086.635.15.202.073.405.166.589.27.193.104.378.228.552.362.165.145.33.3.475.465.146.166.272.352.388.538.117.196.213.393.29.6.087.218.154.436.191.655.047.218.069.558.082.668.014.11.007-.11 0 0M44.098 60.063c.008.22-.005.45-.038.672-.022.22-.075.442-.148.655a3.329 3.329 0 0 1-.25.618 3.525 3.525 0 0 1-.352.562c-.134.185-.289.35-.444.495-.166.145-.341.291-.527.407a3.1 3.1 0 0 1-.57.3 3.573 3.573 0 0 1-1.923.243 3.727 3.727 0 0 1-.636-.16 3.524 3.524 0 0 1-.6-.261 4.802 4.802 0 0 1-.542-.373 3.505 3.505 0 0 1-.475-.464 4.224 4.224 0 0 1-.687-1.138 3.63 3.63 0 0 1-.182-.645 3.793 3.793 0 0 1-.043-1.34c.022-.22.075-.442.138-.664a4.07 4.07 0 0 1 .612-1.18c.134-.175.289-.34.444-.495.165-.146.34-.282.517-.397.187-.117.383-.223.58-.31.208-.076.416-.143.625-.19a3.493 3.493 0 0 1 1.299-.042c.211.033.423.086.635.149.203.073.406.167.59.27.193.105.377.229.551.363.165.145.33.3.476.465.145.165.271.351.387.537.117.197.213.394.29.601.087.218.155.436.192.654.047.219.068.559.081.668.014.11.007-.11 0 0M58.654 45.23c.007.22-.006.441-.039.662a2.8 2.8 0 0 1-.149.635 3.238 3.238 0 0 1-.25.609 3.969 3.969 0 0 1-.352.552c-.135.164-.29.33-.445.474a4.698 4.698 0 0 1-.518.398 4.535 4.535 0 0 1-.58.299 4.502 4.502 0 0 1-.624.19 3.493 3.493 0 0 1-1.29.042 4.502 4.502 0 0 1-.635-.15 4.535 4.535 0 0 1-.599-.26 4.698 4.698 0 0 1-.542-.362 4.993 4.993 0 0 1-.474-.445 3.969 3.969 0 0 1-.687-1.118 3.423 3.423 0 0 1-.18-.625 3.683 3.683 0 0 1-.082-.657c-.007-.22.005-.44.039-.652.022-.22.075-.433.139-.645.073-.202.156-.405.26-.599.104-.193.218-.387.352-.552.135-.174.29-.34.445-.484.165-.146.34-.282.517-.387.187-.117.383-.223.581-.3a3.45 3.45 0 0 1 .624-.19 3.466 3.466 0 0 1 1.29-.042c.21.033.432.076.635.15.202.063.405.156.598.26.184.094.368.218.542.353.165.134.33.289.475.454.146.156.272.342.388.528.116.186.212.383.289.58.087.208.153.416.19.635.047.208.068.538.082.648.013.11.006-.11 0 0M71.406 28.328c.007.22-.006.44-.028.661-.024.211-.066.433-.13.635a5.358 5.358 0 0 1-.22.607 3.773 3.773 0 0 1-1.175 1.42 3.845 3.845 0 0 1-.52.296 3.618 3.618 0 0 1-.554.189 2.76 2.76 0 0 1-1.15.037 3.618 3.618 0 0 1-.565-.152 3.845 3.845 0 0 1-.539-.262 4.116 4.116 0 0 1-.482-.365 3.552 3.552 0 0 1-.772-.975 3.986 3.986 0 0 1-.27-.591 3.399 3.399 0 0 1-.17-.625 4.887 4.887 0 0 1-.072-.658c-.007-.22.006-.44.03-.652.022-.22.065-.432.128-.644.064-.202.137-.405.23-.598.085-.193.188-.386.313-.55.115-.174.25-.339.395-.484.145-.144.3-.28.457-.385.167-.115.343-.221.52-.297a2.78 2.78 0 0 1 .555-.188 2.784 2.784 0 0 1 1.15-.037c.19.033.382.077.565.151.182.064.365.158.539.263.163.094.337.219.481.354.155.135.3.29.425.457.136.155.252.342.358.528.096.187.183.384.259.582.077.208.134.416.17.635.038.209.058.538.072.648.014.11.006-.11 0 0M73.162 61.15c.007.22.004.44-.019.662-.023.21-.066.432-.11.634a5.309 5.309 0 0 1-.2.606 6.855 6.855 0 0 1-.272.55c-.104.163-.23.327-.354.471a3.005 3.005 0 0 1-.858.689c-.158.075-.326.14-.495.186a2.22 2.22 0 0 1-1.02.033 2.842 2.842 0 0 1-.494-.154 3.235 3.235 0 0 1-.48-.264 3.005 3.005 0 0 1-.431-.366 4.056 4.056 0 0 1-.375-.448 4.682 4.682 0 0 1-.318-.53 5.29 5.29 0 0 1-.23-.593 4.42 4.42 0 0 1-.16-.625c-.027-.22-.054-.439-.061-.659-.007-.22.006-.44.019-.65.022-.221.066-.433.119-.645.053-.202.117-.404.19-.596.084-.193.178-.386.283-.55a3.43 3.43 0 0 1 .344-.481c.125-.144.261-.279.408-.384.146-.115.303-.22.46-.295.158-.085.316-.14.485-.186a2.22 2.22 0 0 1 1.02-.033c.17.034.342.079.504.154.163.064.326.159.47.264.152.095.297.22.431.356.135.136.27.292.385.458.105.157.212.343.308.53.086.188.172.385.239.583.057.208.113.416.15.635.037.21.058.539.062.649.013.11.006-.11 0 0",stroke:"#fff",fill:"none",strokeLinecap:"round"})),v||(v=N.createElement("g",{strokeOpacity:.3,fillOpacity:.3,strokeLinecap:"round"},N.createElement("path",{d:"m44.152 101.58 29.65.21 4.98 1.66 3.31 3.31 1.87 8.09v40.72l-.83 5.8-1.04 2.28-3.31 3.32-8.09 1.87-29.65-.21-4.98-1.66-3.31-3.32-1.87-8.08.21-43.83 1.66-4.98 3.31-3.31 8.09-1.87",strokeWidth:0,fill:"#fab005"}),N.createElement("path",{d:"M44.152 101.58h26.54m-26.54 0h26.54m0 0c8.85 0 13.27 4.42 13.27 13.27m-13.27-13.27c8.85 0 13.27 4.42 13.27 13.27m0 0v40.72m0-40.72v40.72m0 0c0 8.84-4.42 13.27-13.27 13.27m13.27-13.27c0 8.84-4.42 13.27-13.27 13.27m0 0h-26.54m26.54 0h-26.54m0 0c-8.85 0-13.27-4.43-13.27-13.27m13.27 13.27c-8.85 0-13.27-4.43-13.27-13.27m0 0v-40.72m0 40.72v-40.72m0 0c0-8.85 4.42-13.27 13.27-13.27m-13.27 13.27c0-8.85 4.42-13.27 13.27-13.27",stroke:"#000",fill:"none"}))),N.createElement("text",{x:18.62,fontFamily:"Virgil, Segoe UI Emoji",fontSize:20,textAnchor:"middle",style:{whiteSpace:"pre"},dominantBaseline:"text-before-edge",transform:"translate(38.418 122.566)",strokeOpacity:.3,fillOpacity:.3},"API"))},O={description:"Extracting shared dependencies across multiple requests",title:"Extracting shared dependencies",id:"shared-dependencies",slug:"../shared-dependencies"},A=void 0,M={unversionedId:"workshop/part-ii/shared-dependencies",id:"workshop/part-ii/shared-dependencies",title:"Extracting shared dependencies",description:"Extracting shared dependencies across multiple requests",source:"@site/docs/workshop/part-ii/03-dependencies.md",sourceDirName:"workshop/part-ii",slug:"/workshop/shared-dependencies",permalink:"/docs/workshop/shared-dependencies",draft:!1,editUrl:"https://github.com/syntasso/kratix-docs/tree/main/docs/workshop/part-ii/03-dependencies.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{description:"Extracting shared dependencies across multiple requests",title:"Extracting shared dependencies",id:"shared-dependencies",slug:"../shared-dependencies"},sidebar:"workshopSidebar",previous:{title:"Delivering your service on demand",permalink:"/docs/workshop/service-on-demand"},next:{title:"Scheduling Promises",permalink:"/docs/workshop/scheduling-promise"}},D={},S=[{value:"Understanding Kratix Promise Dependencies",id:"understanding-dependencies",level:2},{value:"Splitting out Elastic Cloud Kubernetes (ECK) Dependencies",id:"splitting-dependencies",level:2},{value:"Dependencies",id:"dependencies",level:3},{value:"Remove shared dependencies from the Pipeline",id:"remove-shared-dependencies-from-the-pipeline",level:3},{value:"Remove one-off files (i.e. Dependencies) from Pipeline",id:"remove-one-off-files-ie-dependencies-from-pipeline",level:4},{value:"Run the test suite, see it passing",id:"run-the-test-suite-see-it-passing",level:4},{value:"Add shared dependencies to the Promise",id:"add-shared-dependencies-to-the-promise",level:3},{value:"Download the WorkerResourcesBuilder",id:"download-the-workerresourcesbuilder",level:4},{value:"Add all Dependencies to the Promise",id:"add-all-dependencies-to-the-promise",level:4},{value:"Install the Promise",id:"install-promise",level:2},{value:"Prerequisite setup",id:"prerequisite-setup",level:3},{value:"Install the Promise",id:"install-the-promise",level:3},{value:"Make multiple requests",id:"resource-requests",level:2},{value:"Summary",id:"summary",level:2},{value:"Clean up environment",id:"cleanup",level:2},{value:"\ud83c\udf89 \xa0 Congratulations",id:"--congratulations",level:2}],q={toc:S};function I(e){let{components:t,...n}=e;return(0,E.kt)("wrapper",(0,w.Z)({},q,n,{components:t,mdxType:"MDXLayout"}),(0,E.kt)("p",null,"This is Part 2 of ",(0,E.kt)("a",{parentName:"p",href:"intro"},"a series")," illustrating how Kratix works. ",(0,E.kt)("br",null),"\n\ud83d\udc48\ud83c\udffe","\xa0","\xa0"," Previous: ",(0,E.kt)("a",{parentName:"p",href:"service-on-demand"},"Delivering your service on demand")," ",(0,E.kt)("br",null),"\n\ud83d\udc49\ud83c\udffe","\xa0","\xa0"," Next: ",(0,E.kt)("a",{parentName:"p",href:"scheduling-promise"},"Intentionally schedule Promise resources")),(0,E.kt)("hr",null),(0,E.kt)("p",null,(0,E.kt)("strong",{parentName:"p"},"In this tutorial, you will")),(0,E.kt)("ul",null,(0,E.kt)("li",{parentName:"ul"},(0,E.kt)("a",{parentName:"li",href:"#understanding-dependencies"},"Understanding Kratix Promise Dependencies")),(0,E.kt)("li",{parentName:"ul"},(0,E.kt)("a",{parentName:"li",href:"#splitting-dependencies"},"Splitting out Elastic Cloud Kubernetes (ECK) Dependencies"),(0,E.kt)("ul",{parentName:"li"},(0,E.kt)("li",{parentName:"ul"},(0,E.kt)("a",{parentName:"li",href:"#dependencies"},"Dependencies")),(0,E.kt)("li",{parentName:"ul"},(0,E.kt)("a",{parentName:"li",href:"#remove-shared-dependencies-from-the-pipeline"},"Remove shared dependencies from the Pipeline"),(0,E.kt)("ul",{parentName:"li"},(0,E.kt)("li",{parentName:"ul"},(0,E.kt)("a",{parentName:"li",href:"#remove-one-off-files-ie-dependencies-from-pipeline"},"Remove one-off files (i.e. Dependencies) from Pipeline")),(0,E.kt)("li",{parentName:"ul"},(0,E.kt)("a",{parentName:"li",href:"#run-the-test-suite-see-it-passing"},"Run the test suite, see it passing")))),(0,E.kt)("li",{parentName:"ul"},(0,E.kt)("a",{parentName:"li",href:"#add-shared-dependencies-to-the-promise"},"Add shared dependencies to the Promise"),(0,E.kt)("ul",{parentName:"li"},(0,E.kt)("li",{parentName:"ul"},(0,E.kt)("a",{parentName:"li",href:"#download-the-workerresourcesbuilder"},"Download the WorkerResourcesBuilder")),(0,E.kt)("li",{parentName:"ul"},(0,E.kt)("a",{parentName:"li",href:"#add-all-dependencies-to-the-promise"},"Add all Dependencies to the Promise")))))),(0,E.kt)("li",{parentName:"ul"},(0,E.kt)("a",{parentName:"li",href:"#install-the-promise-install-promise"},"Install the Promise {#install-promise}"),(0,E.kt)("ul",{parentName:"li"},(0,E.kt)("li",{parentName:"ul"},(0,E.kt)("a",{parentName:"li",href:"#prerequisite-setup"},"Prerequisite setup")),(0,E.kt)("li",{parentName:"ul"},(0,E.kt)("a",{parentName:"li",href:"#install-the-promise"},"Install the Promise")))),(0,E.kt)("li",{parentName:"ul"},(0,E.kt)("a",{parentName:"li",href:"#make-multiple-requests-resource-requests"},"Make multiple requests {#resource-requests}")),(0,E.kt)("li",{parentName:"ul"},(0,E.kt)("a",{parentName:"li",href:"#summary-summary"},"Summary")),(0,E.kt)("li",{parentName:"ul"},(0,E.kt)("a",{parentName:"li",href:"#clean-up-environment-cleanup"},"Clean up environment {#cleanup}")),(0,E.kt)("li",{parentName:"ul"},(0,E.kt)("a",{parentName:"li",href:"#--congratulations"},"\ud83c\udf89 \xa0 Congratulations"))),(0,E.kt)("h2",{id:"understanding-dependencies"},"Understanding Kratix Promise Dependencies"),(0,E.kt)("p",null,"The ECK Promise has now bundled all necessary provisioning steps into the Resource Workflow. This made it possible to only do a single request because of duplication of fixed dependencies across the requests."),(0,E.kt)("p",null,"In this section we will focus on introducing the Dependencies part of Promises to manage many requests from a single Promise."),(0,E.kt)("figure",{class:"diagram"},(0,E.kt)(C,{className:"small",mdxType:"PromiseWayfinding"}),(0,E.kt)("figcaption",null,"Promise Dependencies provide a way to install and configure shared resources that enables the platform to provide self-service Resources.")),(0,E.kt)("h2",{id:"splitting-dependencies"},"Splitting out Elastic Cloud Kubernetes (ECK) Dependencies"),(0,E.kt)("p",null,"The Pipeline ",(0,E.kt)("inlineCode",{parentName:"p"},"run")," script currently follows the installation instructions in the ECK\ndocumentation ",(0,E.kt)("a",{parentName:"p",href:"https://www.elastic.co/guide/en/cloud-on-k8s/2.8/k8s-deploy-eck.html"},"here"),".\nNamely, the two separate files downloaded, the CRDs and the operator. Then creating\nthe required Resources from the CRDs."),(0,E.kt)("p",null,"The operator and its CRDs are a set of resources that only need and can be\ninstalled once in a cluster. After they are installed they can serve as many\nResources as needed. Therefore, if you want to support provisioning multiple\nResources you will need to change how the CRDs and operator resources are installed\ninto the cluster so that there is not a conflict."),(0,E.kt)("img",{src:(0,x.Z)("/img/docs/workshop/operator-as-shared-dependency.png")}),(0,E.kt)("h3",{id:"dependencies"},"Dependencies"),(0,E.kt)("p",null,"Currently, both the operator and the request for an Resource from the operator\nare generated in the Workflow. Kratix has the concept of ",(0,E.kt)("inlineCode",{parentName:"p"},"dependencies")," which\ncan be useful to manage different types of resources. While a Configure Workflow runs on\nevery request for a resource, the Dependencies are a set of resources that only\nneed to be installed once per cluster for the given Promise."),(0,E.kt)("p",null,"A simple use cases may be to create a shared namespace that all subsequent\nResources get scheduled to. In the case of this ECK Promise, you can\ninstall the Operator and CRDs as Dependencies."),(0,E.kt)("h3",{id:"remove-shared-dependencies-from-the-pipeline"},"Remove shared dependencies from the Pipeline"),(0,E.kt)("p",null,"The following steps will refactor this Promise to instead separate shared dependencies from individual request resources:"),(0,E.kt)("img",{src:(0,x.Z)("/img/docs/workshop/promise-with-dependencies.png")}),(0,E.kt)("h4",{id:"remove-one-off-files-ie-dependencies-from-pipeline"},"Remove one-off files (i.e. Dependencies) from Pipeline"),(0,E.kt)("p",null,"First you will need to remove the Operator and CRD files from the Pipeline ",(0,E.kt)("inlineCode",{parentName:"p"},"run")," script in order in order to stop them from being created on each request for a Resource."),(0,E.kt)("p",null,"Open the ",(0,E.kt)("inlineCode",{parentName:"p"},"pipeline/run")," file and remove lines 9-16. This will remove both curl commands which download the CRDs and controller resources."),(0,E.kt)("details",null,(0,E.kt)("summary",null," \ud83d\udc49\ud83c\udffe Prefer to copy the whole working pipeline/run file? \ud83d\udc48\ud83c\udffe "),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Complete pipeline/run"',title:'"Complete','pipeline/run"':!0},'#!/usr/bin/env bash\n\nset -eu -o pipefail\n\nmkdir -p to-deploy\nexport name="$(yq eval \'.metadata.name\' /kratix/input/object.yaml)"\nexport enableDataCollection="$(yq eval \'.spec.enableDataCollection\' /kratix/input/object.yaml)"\n\necho "Generate ECK requests..."\n# Only set the beats value file if data collection is enabled\nvaluesFile=\'\'\nif $enableDataCollection; then\n  sed "s/NAME/${name}/g" beats-values.yaml > beats-final-values.yaml\n  valuesFile=\'--values beats-final-values.yaml\'\nfi\n\nnodePort="$(echo "${name}" | md5sum | grep -Eo "[[:digit:]]{3}" | head -n1)"\nnodePort=$(( 30000 + nodePort ))\nsed "s/NODEPORT/${nodePort}/g" default-config.yaml | sed "s/NAME/${name}/g" > default-config-final-values.yaml\n\nhelm template $name eck-stack \\\n  $valuesFile \\\n  --values default-config-final-values.yaml \\\n  --repo https://helm.elastic.co \\\n  --output-dir to-deploy\n\necho "Adding namespaces to all helm output files..."\nfind /pipeline/to-deploy/eck-stack -name \\*.yaml   -exec yq -i \'select(.metadata | has("namespace") | not).metadata.namespace |= "default"\' {} \\;\n\necho "Removing enterprise annotation..."\nfind /pipeline/to-deploy/eck-stack -name \\*.yaml   -exec yq -i \'del(.metadata.annotations["eck.k8s.elastic.co/license"])\' {} \\;\n\n\necho "Copying files to /kratix/output..."\nfind /pipeline/to-deploy -name \\*.yaml -exec cp {} /kratix/output \\;\n\nif [ -f /kratix/output/beats.yaml ]; then\n  head -n -1 /kratix/output/beats.yaml > temp.yaml ; mv temp.yaml /kratix/output/beats.yaml\nfi\n\necho "Done"\n'))),(0,E.kt)("h4",{id:"run-the-test-suite-see-it-passing"},"Run the test suite, see it passing"),(0,E.kt)("p",null,"With the downloads removed, you can re-run the test suite and see that the resulting files no long include the Operator or the CRDs."),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-bash"},"./scripts/test-pipeline\n")),(0,E.kt)("p",null,"Once the execution completes, use the following command to check the files generated by the Pipeline:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-bash"},"tree test\n")),(0,E.kt)("p",null,"Verify that the output shows only the following files:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-shell-session"},"\ud83d\udcc2 test\n\u251c\u2500\u2500 input\n\u2502   \u2514\u2500\u2500 object.yaml\n\u251c\u2500\u2500 metadata\n\u2514\u2500\u2500 output\n    \u251c\u2500\u2500 beats.yaml\n    \u251c\u2500\u2500 elasticsearch.yaml\n    \u2514\u2500\u2500 kibana.yaml\n")),(0,E.kt)("h3",{id:"add-shared-dependencies-to-the-promise"},"Add shared dependencies to the Promise"),(0,E.kt)("p",null,"Removing the files from the Pipeline is not enough. You must now also add them to the Promise as Dependencies."),(0,E.kt)("p",null,"Run the following command to create a ",(0,E.kt)("inlineCode",{parentName:"p"},"dependencies")," directory where you can store these files and any others that you may want to depend on for the Promise installation:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir -p dependencies\n\ncurl --silent --location --output dependencies/elastic-crds.yaml https://download.elastic.co/downloads/eck/2.8.0/crds.yaml\ncurl --silent --location --output dependencies/elastic-operator.yaml https://download.elastic.co/downloads/eck/2.8.0/operator.yaml\n")),(0,E.kt)("p",null,"Once stored locally, you will need to add these Dependencies to the Promise file. The Dependencies are added as a list under ",(0,E.kt)("inlineCode",{parentName:"p"},"dependencies")," which can tricky with formatting and require some subtle white space changes."),(0,E.kt)("h4",{id:"download-the-workerresourcesbuilder"},"Download the WorkerResourcesBuilder"),(0,E.kt)("admonition",{type:"info"},(0,E.kt)("p",{parentName:"admonition"},"If you are using Instruqt, you can use the binary provided rather than downloading. When prompted, instead of downloading use the following command to move the binary into the right location:"),(0,E.kt)("pre",{parentName:"admonition"},(0,E.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir -p bin\ncp /root/bin/worker-resource-builder ./bin\n"))),(0,E.kt)(T.ZP,{mdxType:"PartialWcrBinaryDownload"}),(0,E.kt)("h4",{id:"add-all-dependencies-to-the-promise"},"Add all Dependencies to the Promise"),(0,E.kt)("p",null,"Per the usage instructions you have now seen, you can use the provided binary to add Dependencies to an existing Promise. Run the following command to overwrite the current Promise file to add the Dependencies to the existing API and Workflows sections:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-bash"},'echo "current Promise length is: $(wc -l promise.yaml)"\n./bin/worker-resource-builder -resources-dir ./dependencies -promise promise.yaml | tee tmp-promise.yaml  >/dev/null; mv tmp-promise.yaml promise.yaml\necho "new Promise length is: $(wc -l promise.yaml)"\n')),(0,E.kt)("p",null,"The above command will give an output similar to:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-shell-session"},"current Promise length is: 35 promise.yaml\nnew Promise length is: 11398 promise.yaml\n")),(0,E.kt)("p",null,"In this output, you can see that the the files in the ",(0,E.kt)("inlineCode",{parentName:"p"},"dependencies")," directory have now been added to the ",(0,E.kt)("inlineCode",{parentName:"p"},"promise.yaml")," file. You can also check the top of the newly edited ",(0,E.kt)("inlineCode",{parentName:"p"},"promise.yaml")," and see that these resources have been added as list items under the ",(0,E.kt)("inlineCode",{parentName:"p"},"dependencies")," key."),(0,E.kt)("admonition",{type:"info"},(0,E.kt)("p",{parentName:"admonition"},"You may notice that the length of the files in ",(0,E.kt)("inlineCode",{parentName:"p"},"dependencies")," is shorter than what was added to the ",(0,E.kt)("inlineCode",{parentName:"p"},"promise.yaml")," file. This is because the ",(0,E.kt)("inlineCode",{parentName:"p"},"worker-resources-builder")," binary reformatted long lines into more readable lines with a max length of 90."),(0,E.kt)("p",{parentName:"admonition"},"If you have ",(0,E.kt)("a",{parentName:"p",href:"https://mikefarah.gitbook.io/yq/"},"yq")," installed you can verify the total number of documents in both matches with the following command:"),(0,E.kt)("pre",{parentName:"admonition"},(0,E.kt)("code",{parentName:"pre",className:"language-bash"},"diff <(yq ea '[.] | length' dependencies/*) <(yq '.spec.dependencies | length' promise.yaml)\n")),(0,E.kt)("p",{parentName:"admonition"},"No difference in number of YAML resources will result in no output.")),(0,E.kt)("h2",{id:"install-promise"},"Install the Promise"),(0,E.kt)("h3",{id:"prerequisite-setup"},"Prerequisite setup"),(0,E.kt)(P.ZP,{mdxType:"PartialVerifyKratixWithOutPromises"}),(0,E.kt)("h3",{id:"install-the-promise"},"Install the Promise"),(0,E.kt)("p",null,"With the Pipeline image available, you can now install the updated Promise:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl --context ${PLATFORM} create --filename promise.yaml\n")),(0,E.kt)("p",null,"To validate the Promise has been installed, you can list all Promises by running:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl --context kind-platform get promises\n")),(0,E.kt)("p",null,"Your output will show the ",(0,E.kt)("inlineCode",{parentName:"p"},"elastic-cloud")," Promise:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-shell-session"},"NAME            AGE\nelastic-cloud   10s\n")),(0,E.kt)("p",null,"In addition, you can now verify that the Dependencies have been installed on the worker cluster:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl --context ${WORKER} get crds | grep elastic\nkubectl --context ${WORKER} get pods -n elastic-system\n")),(0,E.kt)("p",null,"The above command will give an output similar to:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-shell-session"},"agents.agent.k8s.elastic.co                            2023-02-01T12:00:00Z\napmservers.apm.k8s.elastic.co                          2023-02-01T12:00:00Z\nbeats.beat.k8s.elastic.co                              2023-02-01T12:00:00Z\nelasticmapsservers.maps.k8s.elastic.co                 2023-02-01T12:00:00Z\nelasticsearchautoscalers.autoscaling.k8s.elastic.co    2023-02-01T12:00:00Z\nelasticsearches.elasticsearch.k8s.elastic.co           2023-02-01T12:00:00Z\nenterprisesearches.enterprisesearch.k8s.elastic.co     2023-02-01T12:00:00Z\nkibanas.kibana.k8s.elastic.co                          2023-02-01T12:00:00Z\nlogstashes.logstash.k8s.elastic.co                     2023-02-01T12:00:00Z\nstackconfigpolicies.stackconfigpolicy.k8s.elastic.co   2023-02-01T12:00:00Z\n\nNAME                 READY   STATUS    RESTARTS   AGE\nelastic-operator-0   1/1     Running   0          1m\n")),(0,E.kt)("h2",{id:"resource-requests"},"Make multiple requests"),(0,E.kt)("p",null,"Now that you have installed the operator and CRDs as a part of Promise installation,\nyou can once again don the Application Engineer hat and return to the original goal of\nrequesting more than one Resource from the single ECK Promise."),(0,E.kt)("p",null,"Just as you did in the last step, you will need to make two requests with\ntwo different resource names:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl --context $PLATFORM apply --filename resource-request.yaml\ncat resource-request.yaml | \\\n  sed 's/name: example/name: second-request/' | \\\n  kubectl --context $PLATFORM apply --filename -\n")),(0,E.kt)("p",null,"With these two requests made, you can see both Workflows running simultaneously:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl --context $PLATFORM get pods\n")),(0,E.kt)("p",null,"The above command will give an output similar to:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-shell-session"},"NAME                                     READY   STATUS      RESTARTS   AGE\nconfigure-pipeline-elastic-cloud-01650   0/1     Completed   0          106s\nconfigure-pipeline-elastic-cloud-99684   0/1     Completed   0          11s\n")),(0,E.kt)("p",null,"And once completed you will be able to watch for two sets of ECK resources being deployed to the worker cluster:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl --context $WORKER get pods --watch\n")),(0,E.kt)("p",null,"Once you see all 6 pods in the output similar to below, you can use ",(0,E.kt)("kbd",null,"Ctrl"),"+",(0,E.kt)("kbd",null,"C")," to exit the watch mode:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-shell-session"},"NAME                                 READY   STATUS    RESTARTS   AGE\nexample-es-default-0                 1/1     Running   0          2m21s\nexample-kb-d97b489b-9twhq            1/1     Running   0          2m21s\nexample-beat-metricbeat-frpv7        1/1     Running   0          2m21s\nsecond-request-es-default-0          1/1     Running   0          42s\nsecond-request-kb-6cdc9594ff-7dnnm   1/1     Running   0          42s\n")),(0,E.kt)("details",null,(0,E.kt)("summary",null,"\ud83e\udd14 Want to see these Kibanas in the browser? "),(0,E.kt)("p",null,"The first Kibana has been set up with a unique node port which has been configured to be exposed as a part of the workshop cluster setup."),(0,E.kt)("p",null,"You can visit ",(0,E.kt)("a",{parentName:"p",href:"http://localhost:30269"},"http://localhost:30269")," and check it out, and you can even login by using the default username ",(0,E.kt)("inlineCode",{parentName:"p"},"elastic")," and retrieving the password from the worker cluster with the following command:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl --context $WORKER \\\n  get secret example-es-elastic-user \\\n  --output go-template='{{.data.elastic | base64decode}}'\n")),(0,E.kt)("p",null,"Any additional Kibana's will be given a random other port so you will need to use the following port forward command:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl --context kind-worker port-forward deploy/second-request-kb :5601\n")),(0,E.kt)("p",null,"This command will then give you the following output:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-shell-session"},"Forwarding from 127.0.0.1:51207 -> 5601\nForwarding from [::1]:51207 -> 5601\n")),(0,E.kt)("p",null,"The local port will be randomly generated, but in this output you would use the port 51207."),(0,E.kt)("p",null,"This Kibana would need a different password which you can get from it's secret with this command:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl --context $WORKER \\\n  get secret second-request-es-elastic-user \\\n  --output go-template='{{.data.elastic | base64decode}}'\n")),(0,E.kt)("admonition",{type:"caution"},(0,E.kt)("p",{parentName:"admonition"},"If you gave your ECK Resource a different name, you will nee to substitute the name in the above commands for the correct ones. For example, to port forward you would replace ",(0,E.kt)("inlineCode",{parentName:"p"},"NAME")," with the name of your Resource:"),(0,E.kt)("p",{parentName:"admonition"},"kubectl --context $WORKER port-forward deploy/NAME-kb :5601"))),(0,E.kt)("h2",{id:"summary"},"Summary"),(0,E.kt)("p",null,"And with that, you have reduced duplication by delivering shared dependencies separately from the on-demand service! While this workshop only showcases two Resources both deployed to the same cluster, this architecture can easily be used to support an unlimited number of Resources across an unlimited number of clusters."),(0,E.kt)("p",null,"To recap the steps you took:"),(0,E.kt)("ol",null,(0,E.kt)("li",{parentName:"ol"},"\u2705","\xa0","\xa0","Evaluated what resources are shared dependencies"),(0,E.kt)("li",{parentName:"ol"},"\u2705","\xa0","\xa0","Moved any shared dependencies from Workflows to the Dependencies"),(0,E.kt)("li",{parentName:"ol"},"\u2705","\xa0","\xa0","Viewed the dependency set up on Promise install"),(0,E.kt)("li",{parentName:"ol"},"\u2705","\xa0","\xa0","Successfully request more than one ECK Resources")),(0,E.kt)("h2",{id:"cleanup"},"Clean up environment"),(0,E.kt)("p",null,"Before moving on, please remove the ECK Promise from your cluster."),(0,E.kt)("p",null,"To delete all the Promises:"),(0,E.kt)("pre",null,(0,E.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl --context $PLATFORM delete promises --all\n")),(0,E.kt)("h2",{id:"--congratulations"},"\ud83c\udf89 ","\xa0"," Congratulations"),(0,E.kt)("p",null,"\u2705","\xa0","\xa0","Your Promise can deliver on-demand services that have shared dependencies.",(0,E.kt)("br",null),"\n\ud83d\udc49\ud83c\udffe","\xa0","\xa0","Next you will ",(0,E.kt)("a",{parentName:"p",href:"scheduling-promise"},"Intentionally schedule Promise resources"),"."))}I.isMDXComponent=!0}}]);