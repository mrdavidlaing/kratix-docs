"use strict";(self.webpackChunkkratix_docs=self.webpackChunkkratix_docs||[]).push([[329],{1156:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>t,metadata:()=>c,toc:()=>a});var o=r(5893),i=r(1151);const t={description:"Documentation for writing Promise Workflows using Kratix Pipelines, covering how Kratix internally executes the Pipeline containers",title:"Resource Workflows",sidebar_label:"Workflows",id:"workflows"},s="Workflows",c={id:"main/reference/resources/workflows",title:"Resource Workflows",description:"Documentation for writing Promise Workflows using Kratix Pipelines, covering how Kratix internally executes the Pipeline containers",source:"@site/docs/main/05-reference/05-resources/02-workflows.md",sourceDirName:"main/05-reference/05-resources",slug:"/main/reference/resources/workflows",permalink:"/main/reference/resources/workflows",draft:!1,unlisted:!1,editUrl:"https://github.com/syntasso/kratix-docs/tree/main/docs/main/05-reference/05-resources/02-workflows.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{description:"Documentation for writing Promise Workflows using Kratix Pipelines, covering how Kratix internally executes the Pipeline containers",title:"Resource Workflows",sidebar_label:"Workflows",id:"workflows"},sidebar:"mainSidebar",previous:{title:"Introduction",permalink:"/main/reference/resources/intro"},next:{title:"Deleting",permalink:"/main/reference/resources/delete"}},l={},a=[{value:"Running Workflows",id:"running-workflows",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"workflows",children:"Workflows"}),"\n",(0,o.jsxs)(n.p,{children:["Within a Kratix Promise, you can define two different workflow types:\n",(0,o.jsx)(n.code,{children:"configure"})," and ",(0,o.jsx)(n.code,{children:"delete"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"configure"})," workflow is executed when a Resource is created, updated, or\nreconciled. The ",(0,o.jsx)(n.code,{children:"delete"})," workflow is executed when the Resource is deleted."]}),"\n",(0,o.jsxs)(n.p,{children:["To specify the Resource workflows, you should use the ",(0,o.jsx)(n.code,{children:"workflows.resource"})," key\nin the Promise definition:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"platform: platform.kratix.io/v1alpha1\nkind: Promise\nmetadata:\n  # ...\nspec:\n  # ...\n  workflows:\n    # lifecycle hook for Resources\n    resource:\n      # lifecycle hook for creates/updates/ongoing reconciliation of Resources\n      configure:\n        -  # Pipeline definition\n      # lifecycle hook for deletion of Resources\n      delete:\n        -  # Pipeline definition\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Check out the ",(0,o.jsx)(n.a,{href:"../workflows",children:"Workflows documentation"})," for more details."]}),"\n",(0,o.jsx)(n.h2,{id:"running-workflows",children:"Running Workflows"}),"\n",(0,o.jsx)(n.p,{children:"The Workflows are regularly executed on each Resource. Kubernetes reconciles on\na number of different actions including, but not limited to:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"On the creation of a new Resource"}),"\n",(0,o.jsx)(n.li,{children:"Regular interval (default: 10 hours, not currently configurable)"}),"\n",(0,o.jsx)(n.li,{children:"Recreating or restarting the Kratix Controller"}),"\n",(0,o.jsx)(n.li,{children:"A change to the Resource definition"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"All commands should be idempotent as there is a guarantee that\nthey will be run multiple times a day, and may be run much more frequently\ndepending on other environmental impacts like pod restarts."})]})}function u(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},1151:(e,n,r)=>{r.d(n,{Z:()=>c,a:()=>s});var o=r(7294);const i={},t=o.createContext(i);function s(e){const n=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);